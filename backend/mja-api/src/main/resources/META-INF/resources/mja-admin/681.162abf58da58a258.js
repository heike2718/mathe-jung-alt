"use strict";(self.webpackChunkmja_admin=self.webpackChunkmja_admin||[]).push([[681],{681:(gn,ct,r)=>{r.r(ct),r.d(ct,{raetselRoutes:()=>fn});var s=r(655),e=r(4650),p=r(6895),$=r(7392),M=r(4859),k=r(7155),Fe=r(8739),oe=r(6308),le=r(9814),l=r(9653);const d=(0,l.R7)({source:"Raetsel",events:{RAETSEL_SELECT_PAGE:(0,l.Ky)(),FIND_RAETSEL:(0,l.Ky)(),RAETSEL_FOUND:(0,l.Ky)(),RAETSEL_SELECTED:(0,l.Ky)(),RAETSEL_DETAILS_LOADED:(0,l.Ky)(),GENERATE_RAETSEL_PNG:(0,l.Ky)(),RAETSEL_PNG_GENERATED:(0,l.Ky)(),GENERATE_RAETSEL_PDF:(0,l.Ky)(),RAETSEL_PDF_GENERATED:(0,l.Ky)(),RAETSELSUCHFILTER_CHANGED:(0,l.Ky)(),RAETSEL_CANCEL_SELECTION:(0,l.uZ)(),RESET_RAETSELSUCHFILTER:(0,l.uZ)(),SAVE_RAETSEL:(0,l.Ky)(),RAETSEL_SAVED:(0,l.Ky)()}});var b=r(4614);const Ne={suchstring:"",deskriptoren:[]},Zt={id:"neu",schluessel:"",name:"",status:"ERFASST",schreibgeschuetzt:!0,frage:"",loesung:"",kommentar:"",quelle:b.YU,antwortvorschlaege:[],deskriptoren:[],images:null,raetselPDF:null,grafikInfos:[]};function dt(n){return""===n.suchstring&&0===n.deskriptoren.length}const mt=(0,l.Tz)({name:"raetsel",reducer:(0,l.Lq)({loaded:!1,page:[],paginationState:b.n$,selectableDeskriptoren:[],saveSuccessMessage:void 0,raetselDetails:void 0,raetselSuchfilter:Ne},(0,l.on)(d.raetsel_select_page,(n,t)=>({...n,paginationState:{...n.paginationState,pageDefinition:{pageIndex:t.pageDefinition.pageIndex,pageSize:t.pageDefinition.pageSize,sortDirection:t.pageDefinition.sortDirection}}})),(0,l.on)(d.raetselsuchfilter_changed,(n,t)=>({...n,raetselSuchfilter:t.suchfilter})),(0,l.on)(d.raetsel_found,(n,t)=>({...n,loaded:!0,page:t.treffer.treffer,paginationState:{...n.paginationState,anzahlTreffer:t.treffer.trefferGesamt},raetselDetails:void 0})),(0,l.on)(d.raetsel_details_loaded,(n,t)=>{const a=[];return t.raetselDetails.deskriptoren.forEach(i=>{a.push({id:i.id,name:i.name,selected:!0})}),{...n,raetselDetails:t.raetselDetails,selectableDeskriptoren:a}}),(0,l.on)(d.raetsel_png_generated,(n,t)=>{if(n.raetselDetails){const i={...n.raetselDetails,images:{imageFrage:t.images.imageFrage,imageLoesung:t.images.imageLoesung}};return{...n,raetselDetails:i,generatingOutput:!1}}return{...n}}),(0,l.on)(d.raetsel_saved,(n,t)=>{const a=[];return t.raetselDetails.deskriptoren.forEach(i=>{a.push({id:i.id,name:i.name,selected:!0})}),{...n,raetselDetails:t.raetselDetails,selectableDeskriptoren:a}}),(0,l.on)(d.reset_raetselsuchfilter,(n,t)=>({...n,loaded:!1,page:[],raetselDetails:void 0,raetselSuchfilter:Ne})),(0,l.on)(d.raetsel_cancel_selection,(n,t)=>({...n,raetselDetails:void 0,selectableDeskriptoren:[]})))}),{selectRaetselState:B}=mt,V={isLoaded:(0,l.P1)(B,n=>n.loaded),page:(0,l.P1)(B,n=>n.page),paginationState:(0,l.P1)(B,n=>n.paginationState),raetselDetails:(0,l.P1)(B,n=>n.raetselDetails),suchfilter:(0,l.P1)(B,n=>n.raetselSuchfilter)};var Ue,Q,F,_t,R,N,re,qe,Le,Ge=r(6582),ut=r(2527),Nt=r(6759),m=r(2655),q=r(4351),L=r(4004),T=r(8505),x=r(529);class P{constructor(){Ue.add(this),Q.set(this,(0,e.f3M)(x.eN)),F.set(this,"/raetsel")}findRaetsel(t,a){const i=a.pageIndex*a.pageSize;let o=(new x.LE).set(b.jb,a.pageSize).set(b.wE,i).set(b.wQ,a.sortDirection);t.suchstring&&t.suchstring.trim().length>0&&(o=o.set(b.p6,t.suchstring.trim())),t.deskriptoren.length>0&&(o=o.set(b.GE,(0,s.Q_)(this,Ue,"m",_t).call(this,t))),o=o.set(b.kd,"ORDINAL");const c=(0,s.Q_)(this,F,"f")+"/admin/v2",_=(new x.WM).set("Accept","application/json");return(0,s.Q_)(this,Q,"f").get(c,{headers:_,params:o})}loadRaetselDetails(t){const a=(0,s.Q_)(this,F,"f")+"/v1/"+t.id,i=(new x.WM).set("Accept","application/json");return(0,s.Q_)(this,Q,"f").get(a,{headers:i})}generateRaetselPNGs(t,a){const i=(0,s.Q_)(this,F,"f")+"/v1/PNG/"+t,o=(new x.WM).set("Accept","application/json"),c=(new x.LE).set("layoutAntwortvorschlaege",a);return(0,s.Q_)(this,Q,"f").post(i,a,{headers:o,params:c})}generateRaetselPDF(t,a){const i=(0,s.Q_)(this,F,"f")+"/v1/PDF/"+t,o=(new x.WM).set("Accept","application/json"),c=(new x.LE).set("layoutAntwortvorschlaege",a);return(0,s.Q_)(this,Q,"f").get(i,{headers:o,params:c})}saveRaetsel(t){const a=(0,s.Q_)(this,F,"f")+"/v1",i=(new x.WM).set("Accept","application/json");return"neu"===t.raetsel.id?(0,s.Q_)(this,Q,"f").post(a,t,{headers:i}):(0,s.Q_)(this,Q,"f").put(a,t,{headers:i})}}Q=new WeakMap,F=new WeakMap,Ue=new WeakSet,_t=function(t){let a="";for(let i=0;i<t.deskriptoren.length;i++){const o=t.deskriptoren[i];a+=i<t.deskriptoren.length-1?o.id+",":o.id}return a},P.\u0275fac=function(t){return new(t||P)},P.\u0275prov=e.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"});class O{constructor(){R.set(this,(0,e.f3M)(m.eX)),N.set(this,(0,e.f3M)(P)),re.set(this,(0,e.f3M)(Ge.F0)),qe.set(this,(0,e.f3M)(Nt._b)),Le.set(this,(0,e.f3M)(ut.ez)),this.findRaetsel$=(0,m.GW)(()=>(0,s.Q_)(this,R,"f").pipe((0,m.l4)(d.find_raetsel),(0,q.b)(t=>(0,s.Q_)(this,N,"f").findRaetsel(t.suchfilter,t.pageDefinition)),(0,L.U)(t=>d.raetsel_found({treffer:t})))),this.raetselSelected$=(0,m.GW)(()=>(0,s.Q_)(this,R,"f").pipe((0,m.l4)(d.raetsel_selected),(0,q.b)(t=>(0,s.Q_)(this,N,"f").loadRaetselDetails(t.raetsel)),(0,L.U)(t=>d.raetsel_details_loaded({raetselDetails:t,navigateTo:"raetsel/details"})))),this.showDetails$=(0,m.GW)(()=>(0,s.Q_)(this,R,"f").pipe((0,m.l4)(d.raetsel_details_loaded),(0,T.b)(t=>{(0,s.Q_)(this,re,"f").navigateByUrl(t.navigateTo)})),{dispatch:!1}),this.generateRaetselPng$=(0,m.GW)(()=>(0,s.Q_)(this,R,"f").pipe((0,m.l4)(d.generate_raetsel_png),(0,q.b)(t=>(0,s.Q_)(this,N,"f").generateRaetselPNGs(t.raetselID,t.layoutAntwortvorschlaege)),(0,L.U)(t=>d.raetsel_png_generated({images:t})))),this.generateRaetselPDF$=(0,m.GW)(()=>(0,s.Q_)(this,R,"f").pipe((0,m.l4)(d.generate_raetsel_pdf),(0,q.b)(t=>(0,s.Q_)(this,N,"f").generateRaetselPDF(t.raetselID,t.layoutAntwortvorschlaege)),(0,L.U)(t=>d.raetsel_pdf_generated({pdf:t})))),this.downloadPDF$=(0,m.GW)(()=>(0,s.Q_)(this,R,"f").pipe((0,m.l4)(d.raetsel_pdf_generated),(0,T.b)(t=>{(0,s.Q_)(this,qe,"f").downloadPdf(t.pdf.fileData,t.pdf.fileName)})),{dispatch:!1}),this.cancelSelectiont$=(0,m.GW)(()=>(0,s.Q_)(this,R,"f").pipe((0,m.l4)(d.raetsel_cancel_selection),(0,T.b)(()=>(0,s.Q_)(this,re,"f").navigateByUrl("raetsel/uebersicht"))),{dispatch:!1}),this.saveRaetsel$=(0,m.GW)(()=>(0,s.Q_)(this,R,"f").pipe((0,m.l4)(d.save_raetsel),(0,q.b)(t=>(0,s.Q_)(this,N,"f").saveRaetsel(t.editRaetselPayload)),(0,L.U)(t=>d.raetsel_saved({raetselDetails:t})))),this.raetselSaved$=(0,m.GW)(()=>(0,s.Q_)(this,R,"f").pipe((0,m.l4)(d.raetsel_saved),(0,T.b)(()=>(0,s.Q_)(this,Le,"f").info("R\xe4tsel erfolgreich gespeichert"))),{dispatch:!1})}}R=new WeakMap,N=new WeakMap,re=new WeakMap,qe=new WeakMap,Le=new WeakMap,O.\u0275fac=function(t){return new(t||O)},O.\u0275prov=e.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"});const ce=[(0,l.oY)(mt),(0,m.y3)([O])];var f,He,Je,Ye,Pe=r(7356),Oe=r(7694);class S{constructor(){f.set(this,(0,e.f3M)(l.yh)),He.set(this,(0,e.f3M)(Ge.F0)),this.loaded$=(0,s.Q_)(this,f,"f").select(V.isLoaded),this.page$=(0,s.Q_)(this,f,"f").select(V.page),this.paginationState$=(0,s.Q_)(this,f,"f").select(V.paginationState),this.raetselDetails$=(0,s.Q_)(this,f,"f").select(V.raetselDetails).pipe(Oe.d0,Oe.I8),this.suchfilter$=(0,s.Q_)(this,f,"f").select(V.suchfilter),Je.set(this,(0,e.f3M)(Pe.jf))}triggerSearch(t,a){(0,s.Q_)(this,f,"f").dispatch(d.raetsel_select_page({pageDefinition:a})),(0,s.Q_)(this,f,"f").dispatch(d.find_raetsel({suchfilter:t,pageDefinition:a}))}selectRaetsel(t){(0,s.Q_)(this,f,"f").dispatch(d.raetsel_selected({raetsel:t}))}generiereRaetselOutput(t,a,i){switch(a){case"PNG":(0,s.Q_)(this,f,"f").dispatch(d.generate_raetsel_png({raetselID:t,layoutAntwortvorschlaege:i}));break;case"PDF":(0,s.Q_)(this,f,"f").dispatch(d.generate_raetsel_pdf({raetselID:t,layoutAntwortvorschlaege:i}));break;default:throw new Error("Unbekanntes outputFormat "+a)}}editRaetsel(){(0,s.Q_)(this,He,"f").navigateByUrl("raetsel/editor")}changeSuchfilterWithDeskriptoren(t,a){(0,s.Q_)(this,f,"f").dispatch(d.raetselsuchfilter_changed({suchfilter:{deskriptoren:t,suchstring:a}}))}changeSuchfilterWithSelectableItems(t,a){const i=[];t.forEach(c=>{i.push({id:c.id,name:c.name})});const o={suchstring:a,deskriptoren:i};(0,s.Q_)(this,f,"f").dispatch(d.raetselsuchfilter_changed({suchfilter:o}))}neueRaetselsuche(){(0,s.Q_)(this,f,"f").dispatch(d.reset_raetselsuchfilter()),(0,s.Q_)(this,Je,"f").resetSelection()}cancelSelection(){(0,s.Q_)(this,f,"f").dispatch(d.raetsel_cancel_selection())}createAndEditRaetsel(t){if(void 0===t)return;const a={...Zt,quelle:t};(0,s.Q_)(this,f,"f").dispatch(d.raetsel_details_loaded({raetselDetails:a,navigateTo:"raetsel/editor"}))}initSelectItemsCompomentModel(t,a){const i=[];t.forEach(_=>i.push({id:_.id,name:_.name,selected:!0}));const o=[];return a.forEach(_=>{t.find(rt=>rt.id===_.id)||o.push({id:_.id,name:_.name,selected:!1})}),{ueberschriftAuswahlliste:"Deskriptoren",ueberschriftGewaehlteItems:"gew\xe4hlt:",vorrat:o,gewaehlteItems:i}}saveRaetsel(t){(0,s.Q_)(this,f,"f").dispatch(d.save_raetsel({editRaetselPayload:t}))}}f=new WeakMap,He=new WeakMap,Je=new WeakMap,S.\u0275fac=function(t){return new(t||S)},S.\u0275prov=e.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"});class H{constructor(){Ye.set(this,(0,e.f3M)(S))}connect(t){return(0,s.Q_)(this,Ye,"f").page$}disconnect(t){}}Ye=new WeakMap,H.\u0275fac=function(t){return new(t||H)},H.\u0275prov=e.Yz7({token:H,factory:H.\u0275fac,providedIn:"root"});var ze,We,me,ue,je,gt,v=r(727),pt=r(9841),ft=r(8372),Gt=r(6451),J=r(9777),w=r(9549),de=r(284),Ut=r(4968),qt=r(1884),E=r(890);const Lt=["input"];class X{constructor(){ze.add(this),We.set(this,(0,e.f3M)(S)),me.set(this,new v.w0),ue.set(this,new v.w0),je.set(this,new v.w0),this.inputChanged=new e.vpe,this.selectableItemsChanged=new e.vpe}ngAfterViewInit(){(0,s.YH)(this,ue,(0,s.Q_)(this,We,"f").suchfilter$.subscribe(t=>{t&&(this.input.nativeElement.value=t.suchstring)}),"f"),(0,s.YH)(this,me,(0,Ut.R)(this.input.nativeElement,"keyup").pipe((0,ft.b)(300),(0,qt.x)(),(0,T.b)(()=>{(0,s.Q_)(this,ze,"m",gt).call(this)})).subscribe(),"f")}ngOnDestroy(){(0,s.Q_)(this,me,"f").unsubscribe(),(0,s.Q_)(this,ue,"f").unsubscribe(),(0,s.Q_)(this,je,"f").unsubscribe()}onSelectItemsCompomentModelChanged(t){this.selectableItemsChanged.emit(t)}}We=new WeakMap,me=new WeakMap,ue=new WeakMap,je=new WeakMap,ze=new WeakSet,gt=function(){this.inputChanged.emit(this.input.nativeElement.value)},X.\u0275fac=function(t){return new(t||X)},X.\u0275cmp=e.Xpm({type:X,selectors:[["mja-raetsel-suchfilter-admin"]],viewQuery:function(t,a){if(1&t&&e.Gf(Lt,5),2&t){let i;e.iGM(i=e.CRH())&&(a.input=i.first)}},inputs:{selectItemsCompomentModel:"selectItemsCompomentModel"},outputs:{inputChanged:"inputChanged",selectableItemsChanged:"selectableItemsChanged"},standalone:!0,features:[e.jDz],decls:9,vars:1,consts:[["matInput","","placeholder","Text",1,"mb-2","p-5"],["input",""],[3,"model","modelChanged"]],template:function(t,a){1&t&&(e.TgZ(0,"h2"),e._uU(1,"Suchfilter"),e.qZA(),e.TgZ(2,"mat-form-field")(3,"mat-label"),e._uU(4,"Text"),e.qZA(),e._UZ(5,"input",0,1),e.qZA(),e.ynx(7),e.TgZ(8,"mja-select-items",2),e.NdJ("modelChanged",function(o){return a.onSelectItemsCompomentModelChanged(o)}),e.qZA(),e.BQk()),2&t&&(e.xp6(8),e.Q6J("model",a.selectItemsCompomentModel))},dependencies:[p.ez,w.lN,w.KE,w.hX,de.c,de.Nt,E.NJ],styles:["mat-form-field[_ngcontent-%COMP%]{display:block}"]});var ee,C,Ke,_e,pe,fe,ge,he,ve,xe,Ce,te,ae,ke,ht,$e,g=r(1576);function Pt(n,t){if(1&n){const a=e.EpF();e.ynx(0),e.TgZ(1,"mja-raetsel-suchfilter-admin",21),e.NdJ("inputChanged",function(o){e.CHM(a);const c=e.oxw();return e.KtG(c.onSuchfilterSuchstringChanged(o))})("selectableItemsChanged",function(o){e.CHM(a);const c=e.oxw();return e.KtG(c.onSelectItemsCompomentModelChanged(o))}),e.qZA(),e.TgZ(2,"p"),e._uU(3),e.ALo(4,"json"),e.qZA(),e.BQk()}if(2&n){const a=e.oxw();e.xp6(1),e.Q6J("selectItemsCompomentModel",a.selectItemsCompomentModel),e.xp6(2),e.hij("Suchkriterien: ",e.lcZ(4,2,a.suchfilter),"")}}function Ot(n,t){if(1&n){const a=e.EpF();e.ynx(0),e.TgZ(1,"mja-select-items",22),e.NdJ("modelChanged",function(o){e.CHM(a);const c=e.oxw();return e.KtG(c.onSelectItemsCompomentModelChanged(o))}),e.qZA(),e.TgZ(2,"p"),e._uU(3),e.ALo(4,"json"),e.qZA(),e.BQk()}if(2&n){const a=e.oxw();e.xp6(1),e.Q6J("model",a.selectItemsCompomentModel),e.xp6(2),e.hij("Suchkriterien: ",e.lcZ(4,2,a.suchfilter.deskriptoren),"")}}function Ht(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div",2)(1,"button",23),e.NdJ("click",function(){e.CHM(a);const o=e.oxw();return e.KtG(o.neuesRaetsel())}),e._uU(2,"neues R\xe4tsel"),e.qZA()()}}function Jt(n,t){1&n&&e._UZ(0,"mat-header-cell",24)}function Yt(n,t){1&n&&(e.TgZ(0,"span")(1,"mat-icon"),e._uU(2,"block"),e.qZA()())}function zt(n,t){1&n&&(e.TgZ(0,"span")(1,"mat-icon"),e._uU(2,"check_circle_outline"),e.qZA()())}function Wt(n,t){if(1&n&&(e.TgZ(0,"mat-cell",25),e.YNc(1,Yt,3,0,"span",0),e.YNc(2,zt,3,0,"span",0),e.qZA()),2&n){const a=t.$implicit;e.xp6(1),e.Q6J("ngIf","ERFASST"===a.status),e.xp6(1),e.Q6J("ngIf","FREIGEGEBEN"===a.status)}}function jt(n,t){if(1&n&&(e.TgZ(0,"mat-header-cell",26),e._uU(1),e.qZA()),2&n){const a=e.oxw();e.xp6(1),e.Oqu(a.getHeaderSchluessel())}}function Kt(n,t){if(1&n&&(e.TgZ(0,"mat-cell",27),e._uU(1),e.qZA()),2&n){const a=t.$implicit;e.xp6(1),e.Oqu(a.schluessel)}}function $t(n,t){1&n&&(e.TgZ(0,"mat-header-cell",28),e._uU(1,"Name"),e.qZA())}function Bt(n,t){if(1&n&&(e.TgZ(0,"mat-cell",29),e._uU(1),e.qZA()),2&n){const a=t.$implicit;e.xp6(1),e.hij(" ",a.name," ")}}function Vt(n,t){1&n&&(e.TgZ(0,"mat-header-cell",33),e._uU(1,"Deskriptoren"),e.qZA())}function Xt(n,t){if(1&n&&(e.TgZ(0,"mat-cell",34),e._uU(1),e.qZA()),2&n){const a=t.$implicit,i=e.oxw(2);e.xp6(1),e.hij(" ",i.deskriptorenToString(a)," ")}}function ea(n,t){1&n&&(e.ynx(0,30),e.YNc(1,Vt,2,0,"mat-header-cell",31),e.YNc(2,Xt,2,1,"mat-cell",32),e.BQk())}function ta(n,t){1&n&&(e.TgZ(0,"mat-header-cell",33),e._uU(1,"Kommentar"),e.qZA())}function aa(n,t){if(1&n&&(e.TgZ(0,"mat-cell",34),e._uU(1),e.qZA()),2&n){const a=t.$implicit;e.xp6(1),e.hij(" ",a.kommentar," ")}}function na(n,t){1&n&&(e.ynx(0,35),e.YNc(1,ta,2,0,"mat-header-cell",31),e.YNc(2,aa,2,1,"mat-cell",32),e.BQk())}function ia(n,t){1&n&&e._UZ(0,"mat-header-row")}function sa(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"mat-row",36),e.NdJ("click",function(){const c=e.CHM(a).$implicit,_=e.oxw();return e.KtG(_.onRowClicked(c))}),e.qZA()}}function oa(n,t){1&n&&(e.TgZ(0,"div",37)(1,"div",38),e._uU(2," Quelle: zuerst als Autor:in eintragen lassen, dann neues R\xe4tsel anlegen "),e.qZA()())}const la=function(){return[20,30,50]};class Y{constructor(t){this.changeDetector=t,ee.add(this),this.suchfilter=Ne,this.dataSource=(0,e.f3M)(H),this.coreFacade=(0,e.f3M)(Pe.CI),this.isAdmin=!1,this.anzahlRaetsel=0,this.selectItemsCompomentModel=b.Ys,C.set(this,(0,e.f3M)(S)),Ke.set(this,(0,e.f3M)(J.jE)),_e.set(this,void 0),pe.set(this,new v.w0),fe.set(this,new v.w0),ge.set(this,new v.w0),he.set(this,new v.w0),ve.set(this,new v.w0),xe.set(this,new v.w0),Ce.set(this,new v.w0),te.set(this,0),ae.set(this,"asc"),ke.set(this,void 0)}getScreenSize(){(0,s.YH)(this,_e,window.innerWidth,"f")}ngOnInit(){(0,s.YH)(this,pe,(0,s.Q_)(this,Ke,"f").user$.pipe((0,T.b)(t=>this.isAdmin=t.isAdmin)).subscribe(),"f"),(0,s.YH)(this,he,(0,s.Q_)(this,C,"f").paginationState$.subscribe(t=>{this.anzahlRaetsel=t.anzahlTreffer,(0,s.YH)(this,te,t.pageDefinition.pageIndex,"f"),(0,s.YH)(this,ae,"asc"===t.pageDefinition.sortDirection?"asc":"desc","f")}),"f"),(0,s.YH)(this,ve,(0,pt.a)([(0,s.Q_)(this,C,"f").suchfilter$,this.coreFacade.alleDeskriptoren$]).subscribe(([t,a])=>{t&&(this.selectItemsCompomentModel=(0,s.Q_)(this,C,"f").initSelectItemsCompomentModel(t.deskriptoren,a))}),"f"),(0,s.YH)(this,xe,(0,s.Q_)(this,C,"f").suchfilter$.pipe((0,T.b)(t=>this.suchfilter=t),(0,ft.b)(500),(0,T.b)(()=>{this.paginator&&this.sort&&(0,s.Q_)(this,ee,"m",$e).call(this)})).subscribe(),"f"),(0,s.YH)(this,Ce,this.coreFacade.quelleAdmin$.subscribe(t=>{(0,s.YH)(this,ke,t,"f")}),"f")}ngOnDestroy(){(0,s.Q_)(this,pe,"f").unsubscribe(),(0,s.Q_)(this,he,"f").unsubscribe(),(0,s.Q_)(this,ge,"f").unsubscribe(),(0,s.Q_)(this,fe,"f").unsubscribe(),(0,s.Q_)(this,ve,"f").unsubscribe(),(0,s.Q_)(this,xe,"f").unsubscribe(),(0,s.Q_)(this,Ce,"f").unsubscribe()}ngAfterViewInit(){setTimeout(()=>{},0),(0,s.Q_)(this,ee,"m",ht).call(this),(0,s.YH)(this,ge,(0,Gt.T)(this.sort.sortChange,this.paginator.page).pipe((0,T.b)(()=>{dt(this.suchfilter)||(0,s.Q_)(this,ee,"m",$e).call(this)})).subscribe(),"f"),this.changeDetector.detectChanges()}getDisplayedColumns(){return this.isAdmin?["status","schluessel","name","kommentar"]:["schluessel","name","deskriptoren"]}getHeaderSchluessel(){return(0,s.Q_)(this,_e,"f")>959?"SCHLUESSEL":"SCHL"}deskriptorenToString(t){return function Et(n){if(0===n.length)return"";let t="";for(let a=0;a<n.length;a++){const i=n[a];t+=a<n.length-1?i.name+", ":i.name}return t}(t.deskriptoren)}neueSuche(){(0,s.Q_)(this,C,"f").neueRaetselsuche()}neuesRaetsel(){(0,s.Q_)(this,C,"f").createAndEditRaetsel((0,s.Q_)(this,ke,"f"))}buttonNeueSucheDisabled(){return dt(this.suchfilter)}onRowClicked(t){const a=t;(0,s.Q_)(this,C,"f").selectRaetsel(a)}onSuchfilterSuchstringChanged(t){t.length>=4&&(0,s.Q_)(this,C,"f").changeSuchfilterWithDeskriptoren(this.suchfilter.deskriptoren,t)}onSelectItemsCompomentModelChanged(t){t.gewaehlteItems.length>0&&(0,s.Q_)(this,C,"f").changeSuchfilterWithSelectableItems(t.gewaehlteItems,this.suchfilter.suchstring)}}C=new WeakMap,Ke=new WeakMap,_e=new WeakMap,pe=new WeakMap,fe=new WeakMap,ge=new WeakMap,he=new WeakMap,ve=new WeakMap,xe=new WeakMap,Ce=new WeakMap,te=new WeakMap,ae=new WeakMap,ke=new WeakMap,ee=new WeakSet,ht=function(){this.paginator.pageIndex=(0,s.Q_)(this,te,"f"),this.sort.direction=(0,s.Q_)(this,ae,"f"),(0,s.YH)(this,fe,this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),"f")},$e=function(){const t={pageIndex:this.paginator?this.paginator.pageIndex:(0,s.Q_)(this,te,"f"),pageSize:this.paginator?this.paginator.pageSize:20,sortDirection:this.sort?this.sort.direction:(0,s.Q_)(this,ae,"f")};(0,s.Q_)(this,C,"f").triggerSearch(this.suchfilter,t)},Y.\u0275fac=function(t){return new(t||Y)(e.Y36(e.sBO))},Y.\u0275cmp=e.Xpm({type:Y,selectors:[["mja-raetsel-search"]],viewQuery:function(t,a){if(1&t&&(e.Gf(Fe.NW,5),e.Gf(oe.YE,5)),2&t){let i;e.iGM(i=e.CRH())&&(a.paginator=i.first),e.iGM(i=e.CRH())&&(a.sort=i.first)}},hostBindings:function(t,a){1&t&&e.NdJ("resize",function(o){return a.getScreenSize(o)},!1,e.Jf7)},standalone:!0,features:[e.jDz],decls:27,vars:16,consts:[[4,"ngIf"],["flex","","fxLayout","row","fxLayoutGap","10px","fxLayout.lt-sm","column",1,"mb-2"],["fxLayoutAlign","left center","fxFlex","10"],["mat-raised-button","","color","primary",3,"disabled","click"],["fxLayoutAlign","left center","fxFlex","10",4,"ngIf","ngIfElse"],["showFirstLastButtons","",3,"length","pageSizeOptions"],["matSort","","matSortActive","schluessel","matSortDirection","asc","matSortDisableClear","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","status"],["class","mat-header-cell__1",4,"matHeaderCellDef"],["class","mat-cell__1",4,"matCellDef"],["matColumnDef","schluessel"],["mat-sort-header","","class","mat-header-cell__2",4,"matHeaderCellDef"],["class","mat-cell__2",4,"matCellDef"],["matColumnDef","name"],["class","mat-header-cell__3",4,"matHeaderCellDef"],["class","mat-cell__3",4,"matCellDef"],["matColumnDef","deskriptoren",4,"ngIf"],["matColumnDef","kommentar",4,"ngIf"],[4,"matHeaderRowDef","matHeaderRowDefSticky"],[3,"click",4,"matRowDef","matRowDefColumns"],["keineQuelle",""],[3,"selectItemsCompomentModel","inputChanged","selectableItemsChanged"],[3,"model","modelChanged"],["mat-raised-button","","color","primary",3,"click"],[1,"mat-header-cell__1"],[1,"mat-cell__1"],["mat-sort-header","",1,"mat-header-cell__2"],[1,"mat-cell__2"],[1,"mat-header-cell__3"],[1,"mat-cell__3"],["matColumnDef","deskriptoren"],["class","mat-header-cell__4",4,"matHeaderCellDef"],["class","mat-cell__4",4,"matCellDef"],[1,"mat-header-cell__4"],[1,"mat-cell__4"],["matColumnDef","kommentar"],[3,"click"],["fxLayout","column m-1"],["fxFlex","0 1 calc(80%-20px)"]],template:function(t,a){if(1&t&&(e.TgZ(0,"h1"),e._uU(1,"R\xe4tsel"),e.qZA(),e.YNc(2,Pt,5,4,"ng-container",0),e.YNc(3,Ot,5,4,"ng-container",0),e.TgZ(4,"div",1)(5,"div",2)(6,"button",3),e.NdJ("click",function(){return a.neueSuche()}),e._uU(7,"neue Suche"),e.qZA()(),e.YNc(8,Ht,3,0,"div",4),e.ALo(9,"async"),e.qZA(),e._UZ(10,"mat-paginator",5),e.TgZ(11,"mat-table",6),e.ynx(12,7),e.YNc(13,Jt,1,0,"mat-header-cell",8),e.YNc(14,Wt,3,2,"mat-cell",9),e.BQk(),e.ynx(15,10),e.YNc(16,jt,2,1,"mat-header-cell",11),e.YNc(17,Kt,2,1,"mat-cell",12),e.BQk(),e.ynx(18,13),e.YNc(19,$t,2,0,"mat-header-cell",14),e.YNc(20,Bt,2,1,"mat-cell",15),e.BQk(),e.YNc(21,ea,3,0,"ng-container",16),e.YNc(22,na,3,0,"ng-container",17),e.YNc(23,ia,1,0,"mat-header-row",18),e.YNc(24,sa,1,0,"mat-row",19),e.qZA(),e.YNc(25,oa,3,0,"ng-template",null,20,e.W1O)),2&t){const i=e.MAs(26);e.xp6(2),e.Q6J("ngIf",a.isAdmin),e.xp6(1),e.Q6J("ngIf",!a.isAdmin),e.xp6(3),e.Q6J("disabled",a.buttonNeueSucheDisabled()),e.xp6(2),e.Q6J("ngIf",e.lcZ(9,13,a.coreFacade.existsQuelleAdmin$))("ngIfElse",i),e.xp6(2),e.Q6J("length",a.anzahlRaetsel)("pageSizeOptions",e.DdM(15,la)),e.xp6(1),e.Q6J("dataSource",a.dataSource),e.xp6(10),e.Q6J("ngIf",!a.isAdmin),e.xp6(1),e.Q6J("ngIf",a.isAdmin),e.xp6(1),e.Q6J("matHeaderRowDef",a.getDisplayedColumns())("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",a.getDisplayedColumns())}},dependencies:[p.ez,p.O5,p.Ov,p.Ts,le.o9,g.xw,g.SQ,g.Wh,g.yH,k.p0,k.BZ,k.fO,k.as,k.w1,k.Dz,k.nj,k.ge,k.ev,k.XQ,k.Gk,M.ot,M.lW,Fe.TU,Fe.NW,oe.JX,oe.YE,oe.nU,$.Ps,$.Hw,X,E.NJ],styles:[".mat-row[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{border-bottom:1px solid transparent;border-top:1px solid transparent;cursor:pointer}.mat-row[_ngcontent-%COMP%]:hover   .mat-cell[_ngcontent-%COMP%]{border-color:#000;background-color:#f0efef}.mat-header-cell__1[_ngcontent-%COMP%], .mat-cell__1[_ngcontent-%COMP%]{flex:0 1 5%}.mat-header-cell__2[_ngcontent-%COMP%], .mat-cell__2[_ngcontent-%COMP%]{flex:0 1 10%}.mat-header-cell__3[_ngcontent-%COMP%], .mat-cell__3[_ngcontent-%COMP%]{flex:0 1 30%}.mat-header-cell__4[_ngcontent-%COMP%], .mat-cell__4[_ngcontent-%COMP%]{flex:0 1 55%}@media (max-width: 959px){.mat-header-cell__1[_ngcontent-%COMP%], .mat-cell__1[_ngcontent-%COMP%]{flex:0 1 10%}.mat-header-cell__2[_ngcontent-%COMP%], .mat-cell__2[_ngcontent-%COMP%]{flex:0 1 30%}.mat-header-cell__3[_ngcontent-%COMP%], .mat-cell__3[_ngcontent-%COMP%]{flex:0 1 60%}}"]});var be=r(7331),Te=r(5412),Re=r(4633),Ae=r(266),vt=r(8580),Se=r(9349),z=r(9652),ra=r(5829);const ca=function(n){return{background:n}};let da=(()=>{class n{isKorrekt(){return this.antwortvorschlag.korrekt}}return n.\u0275fac=function(a){return new(a||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["mja-antwortvorschlag"]],inputs:{antwortvorschlag:"antwortvorschlag"},standalone:!0,features:[e.jDz],decls:5,vars:5,consts:[["fxLayout","row wrap","fxLayoutGap","20px","fxLayoutAlign","flex-start",1,"p-10","bordered",3,"ngStyle"],["fxFlex","0 1 calc(2%-20px)"],["fxFlex","0 1 calc(98%-20px)",1,"mb-1"]],template:function(a,i){1&a&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.qZA(),e.TgZ(3,"div",2),e._uU(4),e.qZA()()),2&a&&(e.Q6J("ngStyle",e.VKq(3,ca,i.isKorrekt()?"#d7e6f4":"white")),e.xp6(2),e.hij(" ",i.antwortvorschlag.buchstabe,": "),e.xp6(2),e.Oqu(i.antwortvorschlag.text))},dependencies:[p.ez,p.PC,le.o9,g.xw,g.SQ,g.Wh,g.yH,ra.Zl]}),n})();const Z=(0,l.R7)({source:"Grafik",events:{PRUEFE_GRAFIK:(0,l.Ky)(),GRAFIK_GEPRUEFT:(0,l.Ky)(),GRAFIK_HOCHGELADEN:(0,l.Ky)(),CLEAR_VORSCHAU:(0,l.uZ)()}}),xt=(0,l.Tz)({name:"grafik",reducer:(0,l.Lq)({loaded:!1,pfad:void 0,selectedGrafikSearchResult:void 0},(0,l.on)(Z.pruefe_grafik,(n,t)=>({...n,selectedGrafikSearchResult:void 0})),(0,l.on)(Z.grafik_geprueft,(n,t)=>({...n,loaded:!0,selectedGrafikSearchResult:t.grafikSearchResult})),(0,l.on)(Z.grafik_hochgeladen,(n,t)=>({...n,loaded:!1,selectedGrafikSearchResult:void 0})),(0,l.on)(Z.clear_vorschau,(n,t)=>({...n,loaded:!1,selectedGrafikSearchResult:void 0})))}),{selectGrafikState:Be}=xt,Ct={isLoaded:(0,l.P1)(Be,n=>n.loaded),grafikPfad:(0,l.P1)(Be,n=>n.pfad),selectedGrafikSearchResult:(0,l.P1)(Be,n=>n.selectedGrafikSearchResult)};var Ve,Xe,we,et,tt,G;class W{constructor(){Ve.set(this,(0,e.f3M)(x.eN)),Xe.set(this,"/grafiken/v1")}loadGrafik(t){const a=(new x.WM).set("Accept","application/json");let i=new x.LE;return i=i.set("pfad",t),(0,s.Q_)(this,Ve,"f").get((0,s.Q_)(this,Xe,"f"),{headers:a,params:i})}}Ve=new WeakMap,Xe=new WeakMap,W.\u0275fac=function(t){return new(t||W)},W.\u0275prov=e.Yz7({token:W,factory:W.\u0275fac,providedIn:"root"});class j{constructor(){we.set(this,(0,e.f3M)(m.eX)),et.set(this,(0,e.f3M)(W)),tt.set(this,(0,e.f3M)(ut.ez)),this.pruefeGrafik$=(0,m.GW)(()=>(0,s.Q_)(this,we,"f").pipe((0,m.l4)(Z.pruefe_grafik),(0,q.b)(t=>(0,s.Q_)(this,et,"f").loadGrafik(t.pfad)),(0,L.U)(t=>Z.grafik_geprueft({grafikSearchResult:t})))),this.grafikHochgeladen$=(0,m.GW)(()=>(0,s.Q_)(this,we,"f").pipe((0,m.l4)(Z.grafik_hochgeladen),(0,T.b)(t=>{(0,s.Q_)(this,tt,"f").message(t.message)})),{dispatch:!1})}}we=new WeakMap,et=new WeakMap,tt=new WeakMap,j.\u0275fac=function(t){return new(t||j)},j.\u0275prov=e.Yz7({token:j,factory:j.\u0275fac,providedIn:"root"});class D{constructor(){G.set(this,(0,e.f3M)(l.yh)),this.isLoaded$=(0,s.Q_)(this,G,"f").select(Ct.isLoaded),this.grafikSearchResult$=(0,Oe.d0)((0,s.Q_)(this,G,"f").select(Ct.selectedGrafikSearchResult))}grafikPruefen(t){(0,s.Q_)(this,G,"f").dispatch(Z.pruefe_grafik({pfad:t}))}grafikHochgeladen(t){(0,s.Q_)(this,G,"f").dispatch(Z.grafik_hochgeladen({message:t}))}handleUploadError(t){}clearVorschau(){(0,s.Q_)(this,G,"f").dispatch(Z.clear_vorschau())}}G=new WeakMap,D.\u0275fac=function(t){return new(t||D)},D.\u0275prov=e.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"});const Ze=[(0,l.oY)(xt),(0,m.y3)([j])];var I,Ee,De,at,Ie,U,nt;function fa(n,t){if(1&n&&(e.TgZ(0,"div",8),e._uU(1),e.qZA()),2&n){const a=e.oxw().ngIf;e.xp6(1),e.AsE(" ",a.pfad,": ",a.messagePayload.message," ")}}function ga(n,t){if(1&n&&(e.TgZ(0,"div",10),e._UZ(1,"img",11),e.qZA()),2&n){const a=e.oxw(2).ngIf;e.xp6(1),e.MGl("src","data:image/png;base64,",a.image,"",e.LSH)}}function ha(n,t){if(1&n&&(e.TgZ(0,"div",8),e._uU(1),e.YNc(2,ga,2,1,"div",9),e.qZA()),2&n){const a=e.oxw().ngIf;e.xp6(1),e.hij(" ",a.pfad,": Alles gut: Grafik ist schon hochgeladen. "),e.xp6(1),e.Q6J("ngIf",null!==a.image)}}function va(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div")(1,"mja-file-upload",12),e.NdJ("dateiAusgewaehlt",function(o){e.CHM(a);const c=e.oxw(3);return e.KtG(c.onDateiAusgewaehlt(o))})("responsePayload",function(o){e.CHM(a);const c=e.oxw(3);return e.KtG(c.onResponse(o))}),e.qZA()()}if(2&n){const a=e.oxw(3);e.xp6(1),e.Q6J("uploadModel",a.uploadModel)}}function xa(n,t){if(1&n){const a=e.EpF();e.ynx(0),e.YNc(1,fa,2,2,"div",4),e.YNc(2,ha,3,2,"div",4),e.YNc(3,va,2,1,"div",3),e.TgZ(4,"div",5)(5,"div",6)(6,"button",7),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(2);return e.KtG(o.reset())}),e._uU(7,"leeren"),e.qZA()()(),e.BQk()}if(2&n){const a=t.ngIf,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf","INFO"!==a.messagePayload.level),e.xp6(1),e.Q6J("ngIf","INFO"===a.messagePayload.level),e.xp6(1),e.Q6J("ngIf",""!==i.uploadModel.pfad)}}function Ca(n,t){if(1&n&&(e.TgZ(0,"div",2),e.YNc(1,xa,8,3,"ng-container",3),e.ALo(2,"async"),e.qZA()),2&n){const a=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,a.grafikFacade.grafikSearchResult$))}}function ka(n,t){1&n&&(e.TgZ(0,"p"),e._uU(1,"zum Pr\xfcfen auf info klicken"),e.qZA())}class ne{constructor(){this.grafikFacade=(0,e.f3M)(D),this.responsePayload=new e.vpe,this.uploadModel={pfad:"",titel:"Grafik hochladen",maxSizeBytes:2097152,errorMessageSize:"Die Datei ist zu gro\xdf. Die maximale erlaubte Gr\xf6\xdfe ist 2 MB.",accept:".eps",acceptMessage:"erlaubte Dateitypen: eps"},this.grafikSelected=!1,I.set(this,(0,e.f3M)(D)),Ee.set(this,new v.w0)}ngOnInit(){(0,s.YH)(this,Ee,(0,s.Q_)(this,I,"f").grafikSearchResult$.subscribe(t=>{t&&(this.uploadModel={...this.uploadModel,pfad:t.pfad},this.grafikSelected=!0)}),"f")}ngOnDestroy(){(0,s.Q_)(this,I,"f").clearVorschau(),(0,s.Q_)(this,Ee,"f").unsubscribe()}onDateiAusgewaehlt(t){}onResponse(t){if(t){const a=this.uploadModel.pfad+": "+t.message,i={...t,message:a};"INFO"===i.level&&((0,s.Q_)(this,I,"f").grafikHochgeladen(i),(0,s.Q_)(this,I,"f").grafikPruefen(this.uploadModel.pfad)),(0,s.Q_)(this,I,"f").grafikHochgeladen(i),(0,s.Q_)(this,I,"f").grafikPruefen(this.uploadModel.pfad),this.responsePayload.emit({level:t.level,message:this.uploadModel.pfad})}}reset(){this.grafikSelected=!1,this.uploadModel={...this.uploadModel,pfad:""},(0,s.Q_)(this,I,"f").clearVorschau()}}function ba(n,t){if(1&n&&(e.TgZ(0,"div")(1,"mat-chip"),e._uU(2),e.qZA()()),2&n){const a=t.$implicit;e.xp6(2),e.Oqu(a.name)}}function Ta(n,t){if(1&n&&e._UZ(0,"mja-frage-loesung-images",8),2&n){const a=e.oxw().ngIf;e.Q6J("images",a.images)}}function Ra(n,t){if(1&n&&(e.TgZ(0,"div"),e._UZ(1,"mja-antwortvorschlag",10),e.qZA()),2&n){const a=t.$implicit;e.xp6(1),e.Q6J("antwortvorschlag",a)}}function Aa(n,t){if(1&n&&(e.TgZ(0,"div")(1,"mat-accordion")(2,"mat-expansion-panel")(3,"mat-expansion-panel-header")(4,"mat-panel-title"),e._uU(5," Antwortvorschl\xe4ge "),e.qZA()(),e.TgZ(6,"div",9),e.YNc(7,Ra,2,1,"div",6),e.qZA()()()()),2&n){const a=e.oxw().ngIf;e.xp6(7),e.Q6J("ngForOf",a.antwortvorschlaege)}}function Sa(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div")(1,"div",11)(2,"div",12)(3,"button",13),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(3);return e.KtG(o.openPrintPDFDialog())}),e._uU(4,"PDF generieren"),e.qZA()(),e.TgZ(5,"div",12)(6,"button",14),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(3);return e.KtG(o.gotoRaetselUebersicht())}),e._uU(7,"Suche"),e.qZA()()()()}if(2&n){const a=e.oxw(3);e.xp6(3),e.Q6J("disabled",a.generierenDiabled())}}function wa(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div",12)(1,"button",14),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(4);return e.KtG(o.startEdit())}),e._uU(2,"bearbeiten"),e.qZA()()}}function Za(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div",12)(1,"button",22),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(4);return e.KtG(o.openPrintPNGDialog())}),e._uU(2,"PNG generieren"),e.qZA()()}if(2&n){const a=e.oxw(4);e.xp6(1),e.Q6J("disabled",a.generierenDiabled())}}function Ea(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"mat-list-item"),e._uU(1),e.TgZ(2,"button",24),e.NdJ("click",function(){const c=e.CHM(a).$implicit,_=e.oxw(5);return e.KtG(_.grafikLaden(c.pfad))}),e.TgZ(3,"mat-icon"),e._uU(4,"info"),e.qZA()()()}if(2&n){const a=t.$implicit;e.xp6(1),e.hij(" ",a.pfad," ")}}function Da(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"mat-panel-title"),e._uU(3," Grafiken "),e.qZA()(),e.TgZ(4,"mat-nav-list"),e.YNc(5,Ea,5,1,"mat-list-item",6),e.qZA(),e.TgZ(6,"mja-grafik",23),e.NdJ("responsePayload",function(o){e.CHM(a);const c=e.oxw(4);return e.KtG(c.onGrafikHochgeladen(o))}),e.qZA()()}if(2&n){const a=e.oxw(2).ngIf;e.xp6(5),e.Q6J("ngForOf",a.grafikInfos)}}function Ia(n,t){if(1&n&&(e.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"mat-panel-title"),e._uU(3," L\xf6sung (LaTeX) "),e.qZA()(),e.TgZ(4,"textarea",20,21),e._uU(6),e.qZA()()),2&n){const a=e.oxw(2).ngIf;e.xp6(6),e.Oqu(a.loesung)}}function Ma(n,t){if(1&n&&(e.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"mat-panel-title"),e._uU(3," Kommentar "),e.qZA()(),e.TgZ(4,"textarea",20,21),e._uU(6),e.qZA()()),2&n){const a=e.oxw(2).ngIf;e.xp6(6),e.Oqu(a.kommentar)}}function Qa(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div")(1,"h2"),e._uU(2,"Metadaten und LaTeX"),e.qZA(),e.TgZ(3,"div",11),e.YNc(4,wa,3,0,"div",15),e.YNc(5,Za,3,1,"div",15),e.TgZ(6,"div",12)(7,"button",16),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(3);return e.KtG(o.openPrintPDFDialog())}),e._uU(8,"PDF generieren"),e.qZA()(),e.TgZ(9,"div",12)(10,"button",17),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(3);return e.KtG(o.gotoRaetselUebersicht())}),e._uU(11,"R\xe4tselsuche"),e.qZA()()(),e.TgZ(12,"div",18)(13,"div",11)(14,"div",12)(15,"mat-label"),e._uU(16,"ID:"),e.qZA()(),e.TgZ(17,"div",19),e._uU(18),e.qZA()(),e.TgZ(19,"div",11)(20,"div",12)(21,"mat-label"),e._uU(22,"Name:"),e.qZA()(),e.TgZ(23,"div",19),e._uU(24),e.qZA()(),e.TgZ(25,"div",11)(26,"div",12)(27,"mat-label"),e._uU(28,"Quelle:"),e.qZA()(),e.TgZ(29,"div",19),e._uU(30),e.qZA()(),e.TgZ(31,"div",11)(32,"div",12)(33,"mat-label"),e._uU(34,"Status:"),e.qZA()(),e.TgZ(35,"div",19),e._uU(36),e.qZA()()(),e.TgZ(37,"mat-accordion"),e.YNc(38,Da,7,1,"mat-expansion-panel",0),e.TgZ(39,"mat-expansion-panel")(40,"mat-expansion-panel-header")(41,"mat-panel-title"),e._uU(42," Frage (LaTeX) "),e.qZA()(),e.TgZ(43,"textarea",20,21),e._uU(45),e.qZA()(),e.YNc(46,Ia,7,1,"mat-expansion-panel",0),e.YNc(47,Ma,7,1,"mat-expansion-panel",0),e.qZA()()}if(2&n){const a=e.oxw().ngIf,i=e.oxw(2);e.xp6(4),e.Q6J("ngIf",!a.schreibgeschuetzt),e.xp6(1),e.Q6J("ngIf",!a.schreibgeschuetzt),e.xp6(2),e.Q6J("disabled",i.generierenDiabled()),e.xp6(11),e.Oqu(a.id),e.xp6(6),e.Oqu(a.name),e.xp6(6),e.Oqu(a.quelle.name),e.xp6(6),e.Oqu(a.status),e.xp6(2),e.Q6J("ngIf",0!==a.grafikInfos.length),e.xp6(7),e.Oqu(a.frage),e.xp6(1),e.Q6J("ngIf",a.loesung),e.xp6(1),e.Q6J("ngIf",a.kommentar)}}function ya(n,t){if(1&n&&(e.TgZ(0,"div",3)(1,"h1"),e._uU(2),e.qZA(),e.TgZ(3,"div",4)(4,"div",5)(5,"mat-chip-list"),e.YNc(6,ba,3,1,"div",6),e.qZA()()(),e.YNc(7,Ta,1,1,"mja-frage-loesung-images",7),e.YNc(8,Aa,8,1,"div",0),e.YNc(9,Sa,8,1,"div",0),e.YNc(10,Qa,48,11,"div",0),e.qZA()),2&n){const a=t.ngIf,i=e.oxw().ngIf;e.xp6(2),e.hij("R\xe4tsel ",a.schluessel,""),e.xp6(4),e.Q6J("ngForOf",a.deskriptoren),e.xp6(1),e.Q6J("ngIf",a.images),e.xp6(1),e.Q6J("ngIf",a.antwortvorschlaege.length>0),e.xp6(1),e.Q6J("ngIf",!i.isAdmin),e.xp6(1),e.Q6J("ngIf",i.isAdmin)}}function Fa(n,t){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,ya,11,6,"div",2),e.ALo(2,"async"),e.qZA()),2&n){const a=e.oxw(),i=e.MAs(3);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,a.raetselFacade.raetselDetails$))("ngIfElse",i)}}function Na(n,t){1&n&&(e.TgZ(0,"h1"),e._uU(1,"R\xe4tsel Details"),e.qZA(),e.TgZ(2,"p"),e._uU(3,"kein R\xe4tsel gew\xe4hlt"),e.qZA())}I=new WeakMap,Ee=new WeakMap,ne.\u0275fac=function(t){return new(t||ne)},ne.\u0275cmp=e.Xpm({type:ne,selectors:[["mja-grafik"]],outputs:{responsePayload:"responsePayload"},standalone:!0,features:[e.jDz],decls:3,vars:1,consts:[["else","","grafikNichtGeladen","",4,"ngIf"],["grafikNichtGeladen",""],["else","","grafikNichtGeladen",""],[4,"ngIf"],["class","bordered bg-white",4,"ngIf"],["fxLayout","row wrap","fxLayoutGap","20px","fxLayoutAlign","flex-start"],["fxFlex","0 1 calc(25%-20px)"],["mat-raised-button","","color","primary",3,"click"],[1,"bordered","bg-white"],["class","bg-white mt-1",4,"ngIf"],[1,"bg-white","mt-1"],[3,"src"],[3,"uploadModel","dateiAusgewaehlt","responsePayload"]],template:function(t,a){1&t&&(e.YNc(0,Ca,3,3,"div",0),e.YNc(1,ka,2,0,"ng-template",null,1,e.W1O)),2&t&&e.Q6J("ngIf",a.grafikSelected)},dependencies:[p.ez,p.O5,p.Ov,E.Yr,M.ot,M.lW]});class ie{constructor(){De.add(this),this.raetselFacade=(0,e.f3M)(S),this.authFacade=(0,e.f3M)(J.jE),this.grafikFacade=(0,e.f3M)(D),this.dialog=(0,e.f3M)(Te.uw),at.set(this,(0,e.f3M)(Ge.F0)),Ie.set(this,new v.w0),U.set(this,void 0)}ngOnInit(){(0,s.YH)(this,Ie,this.raetselFacade.raetselDetails$.pipe((0,T.b)(t=>{console.log("raetselDetails changed"),(0,s.YH)(this,U,t,"f")})).subscribe(),"f")}ngOnDestroy(){(0,s.Q_)(this,Ie,"f").unsubscribe()}startEdit(){(0,s.Q_)(this,U,"f")&&this.raetselFacade.editRaetsel()}openPrintPNGDialog(){(0,s.Q_)(this,De,"m",nt).call(this,"PNG")}openPrintPDFDialog(){(0,s.Q_)(this,De,"m",nt).call(this,"PDF")}gotoRaetselUebersicht(){(0,s.Q_)(this,at,"f").navigateByUrl("/raetsel")}generierenDiabled(){return(0,s.Q_)(this,U,"f").grafikInfos.filter(a=>!a.existiert).length>0}grafikLaden(t){this.grafikFacade.grafikPruefen(t)}onGrafikHochgeladen(t){"INFO"===t.level&&this.raetselFacade.selectRaetsel((0,s.Q_)(this,U,"f"))}}at=new WeakMap,Ie=new WeakMap,U=new WeakMap,De=new WeakSet,nt=function(t){const a={titel:t+" generieren",layoutsAntwortvorschlaegeInput:b.fq,selectedLayoutAntwortvorschlaege:void 0};this.dialog.open(E.v4,{height:"300px",width:"700px",data:a}).afterClosed().subscribe(o=>{if(o&&a.selectedLayoutAntwortvorschlaege){let c="NOOP";switch(a.selectedLayoutAntwortvorschlaege){case"ANKREUZTABELLE":c="ANKREUZTABELLE";break;case"BUCHSTABEN":c="BUCHSTABEN";break;case"DESCRIPTION":c="DESCRIPTION"}this.raetselFacade.generiereRaetselOutput((0,s.Q_)(this,U,"f").id,t,c)}})},ie.\u0275fac=function(t){return new(t||ie)},ie.\u0275cmp=e.Xpm({type:ie,selectors:[["mja-raetsel-details"]],standalone:!0,features:[e.jDz],decls:4,vars:3,consts:[[4,"ngIf"],["keinRaetsel",""],["fxLayout","column","fxLayoutGap","20px",4,"ngIf","ngIfElse"],["fxLayout","column","fxLayoutGap","20px"],["fxLayout","row","fxLayoutAlign","space-between"],["fxLayout","column"],[4,"ngFor","ngForOf"],[3,"images",4,"ngIf"],[3,"images"],["fxLayout","column","fxLayoutGap","10px"],[3,"antwortvorschlag"],["flex","","fxLayout","row","fxLayoutGap","10px","fxLayout.lt-sm","column"],["fxLayoutAlign","left center","fxFlex","20"],["fxFlexFill","","mat-raised-button","","color","primary",3,"disabled","click"],["fxFlexFill","","mat-raised-button","","color","primary",3,"click"],["fxLayoutAlign","left center","fxFlex","20",4,"ngIf"],["fxFlexFill","","mat-raised-button","","color","primary","matTooltip","PDF generieren",3,"disabled","click"],["fxFlexFill","","mat-raised-button","","color","primary","matTooltip","zur\xfcck zur Suche",3,"click"],[1,"container"],["fxLayoutAlign","left center","fxFlex","80"],["cdkTextareaAutosize","","rows","5","cols","120","disabled","true"],["autosize","cdkTextareaAutosize"],["fxFlexFill","","mat-raised-button","","color","primary","matTooltip","PNG Frage und L\xf6sung generieren",3,"disabled","click"],[3,"responsePayload"],["mat-icon-button","",3,"click"]],template:function(t,a){1&t&&(e.YNc(0,Fa,3,4,"div",0),e.ALo(1,"async"),e.YNc(2,Na,4,0,"ng-template",null,1,e.W1O)),2&t&&e.Q6J("ngIf",e.lcZ(1,1,a.authFacade.user$))},dependencies:[p.ez,p.sg,p.O5,p.Ov,vt.XD,le.o9,g.xw,g.SQ,g.Wh,g.s9,g.yH,z.To,z.pp,z.ib,z.yz,z.yK,be.Hi,be.qn,be.HS,M.ot,M.lW,Te.Is,$.Ps,$.Hw,w.lN,w.hX,Re.ie,Re.Hk,Re.Tg,Ae.AV,Ae.gM,Se.Ky,Se.IC,E.GR,da,ne],styles:[".container[_ngcontent-%COMP%]{margin:20pt 0 20pt 5pt}"]});var kt=r(9643),y=r(3238),Ga=r(2687),bt=r(1281),u=r(4006);const Ua=["input"],qa=function(n){return{enterDuration:n}},La=["*"],Pa=new e.OlP("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1})});let Oa=0;const Ha={provide:u.JU,useExisting:(0,e.Gpc)(()=>Tt),multi:!0};class Ja{constructor(t,a){this.source=t,this.checked=a}}const Ya=(0,y.sb)((0,y.pj)((0,y.Kr)((0,y.Id)(class{constructor(n){this._elementRef=n}}))));let za=(()=>{class n extends Ya{constructor(a,i,o,c,_,ye,rt){super(a),this._focusMonitor=i,this._changeDetectorRef=o,this.defaults=_,this._onChange=vn=>{},this._onTouched=()=>{},this._required=!1,this._checked=!1,this.name=null,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.change=new e.vpe,this.toggleChange=new e.vpe,this.tabIndex=parseInt(c)||0,this.color=this.defaultColor=_.color||"accent",this._noopAnimations="NoopAnimations"===ye,this.id=this._uniqueId=`${rt}${++Oa}`}get required(){return this._required}set required(a){this._required=(0,bt.Ig)(a)}get checked(){return this._checked}set checked(a){this._checked=(0,bt.Ig)(a),this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(a=>{"keyboard"===a||"program"===a?this._focused=!0:a||Promise.resolve().then(()=>{this._focused=!1,this._onTouched(),this._changeDetectorRef.markForCheck()})})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}writeValue(a){this.checked=!!a}registerOnChange(a){this._onChange=a}registerOnTouched(a){this._onTouched=a}setDisabledState(a){this.disabled=a,this._changeDetectorRef.markForCheck()}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(this._createChangeEvent(this.checked))}}return n.\u0275fac=function(a){e.$Z()},n.\u0275dir=e.lG2({type:n,inputs:{name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],required:"required",checked:"checked"},outputs:{change:"change",toggleChange:"toggleChange"},features:[e.qOj]}),n})(),Tt=(()=>{class n extends za{constructor(a,i,o,c,_,ye){super(a,i,o,c,_,ye,"mat-slide-toggle-")}_createChangeEvent(a){return new Ja(this,a)}_onChangeEvent(a){a.stopPropagation(),this.toggleChange.emit(),this.defaults.disableToggleValue?this._inputElement.nativeElement.checked=this.checked:(this.checked=this._inputElement.nativeElement.checked,this._emitChangeEvent())}_onInputClick(a){a.stopPropagation()}focus(a,i){i?this._focusMonitor.focusVia(this._inputElement,i,a):this._inputElement.nativeElement.focus(a)}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}}return n.\u0275fac=function(a){return new(a||n)(e.Y36(e.SBq),e.Y36(Ga.tE),e.Y36(e.sBO),e.$8M("tabindex"),e.Y36(Pa),e.Y36(e.QbO,8))},n.\u0275cmp=e.Xpm({type:n,selectors:[["mat-slide-toggle"]],viewQuery:function(a,i){if(1&a&&e.Gf(Ua,5),2&a){let o;e.iGM(o=e.CRH())&&(i._inputElement=o.first)}},hostAttrs:[1,"mat-slide-toggle"],hostVars:13,hostBindings:function(a,i){2&a&&(e.Ikx("id",i.id),e.uIk("tabindex",null)("aria-label",null)("aria-labelledby",null)("name",null),e.ekj("mat-checked",i.checked)("mat-disabled",i.disabled)("mat-slide-toggle-label-before","before"==i.labelPosition)("_mat-animation-noopable",i._noopAnimations))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matSlideToggle"],features:[e._Bn([Ha]),e.qOj],ngContentSelectors:La,decls:14,vars:20,consts:[[1,"mat-slide-toggle-label"],["label",""],[1,"mat-slide-toggle-bar"],["type","checkbox","role","switch",1,"mat-slide-toggle-input","cdk-visually-hidden",3,"id","required","tabIndex","checked","disabled","change","click"],["input",""],[1,"mat-slide-toggle-thumb-container"],[1,"mat-slide-toggle-thumb"],["mat-ripple","",1,"mat-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-slide-toggle-persistent-ripple"],[1,"mat-slide-toggle-content",3,"cdkObserveContent"],["labelContent",""],[2,"display","none"]],template:function(a,i){if(1&a&&(e.F$t(),e.TgZ(0,"label",0,1)(2,"span",2)(3,"input",3,4),e.NdJ("change",function(c){return i._onChangeEvent(c)})("click",function(c){return i._onInputClick(c)}),e.qZA(),e.TgZ(5,"span",5),e._UZ(6,"span",6),e.TgZ(7,"span",7),e._UZ(8,"span",8),e.qZA()()(),e.TgZ(9,"span",9,10),e.NdJ("cdkObserveContent",function(){return i._onLabelTextChange()}),e.TgZ(11,"span",11),e._uU(12,"\xa0"),e.qZA(),e.Hsn(13),e.qZA()()),2&a){const o=e.MAs(1),c=e.MAs(10);e.uIk("for",i.inputId),e.xp6(2),e.ekj("mat-slide-toggle-bar-no-side-margin",!c.textContent||!c.textContent.trim()),e.xp6(1),e.Q6J("id",i.inputId)("required",i.required)("tabIndex",i.tabIndex)("checked",i.checked)("disabled",i.disabled),e.uIk("name",i.name)("aria-checked",i.checked)("aria-label",i.ariaLabel)("aria-labelledby",i.ariaLabelledby)("aria-describedby",i.ariaDescribedby),e.xp6(4),e.Q6J("matRippleTrigger",o)("matRippleDisabled",i.disableRipple||i.disabled)("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",e.VKq(18,qa,i._noopAnimations?0:150))}},dependencies:[y.wG,kt.wD],styles:['.mat-slide-toggle{display:inline-block;height:24px;max-width:100%;line-height:24px;white-space:nowrap;outline:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(16px, 0, 0)}[dir=rtl] .mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(-16px, 0, 0)}.mat-slide-toggle.mat-disabled{opacity:.38}.mat-slide-toggle.mat-disabled .mat-slide-toggle-label,.mat-slide-toggle.mat-disabled .mat-slide-toggle-thumb-container{cursor:default}.mat-slide-toggle-label{-webkit-user-select:none;user-select:none;display:flex;flex:1;flex-direction:row;align-items:center;height:inherit;cursor:pointer}.mat-slide-toggle-content{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-slide-toggle-label-before .mat-slide-toggle-label{order:1}.mat-slide-toggle-label-before .mat-slide-toggle-bar{order:2}[dir=rtl] .mat-slide-toggle-label-before .mat-slide-toggle-bar,.mat-slide-toggle-bar{margin-right:8px;margin-left:0}[dir=rtl] .mat-slide-toggle-bar,.mat-slide-toggle-label-before .mat-slide-toggle-bar{margin-left:8px;margin-right:0}.mat-slide-toggle-bar-no-side-margin{margin-left:0;margin-right:0}.mat-slide-toggle-thumb-container{position:absolute;z-index:1;width:20px;height:20px;top:-3px;left:0;transform:translate3d(0, 0, 0);transition:all 80ms linear;transition-property:transform}._mat-animation-noopable .mat-slide-toggle-thumb-container{transition:none}[dir=rtl] .mat-slide-toggle-thumb-container{left:auto;right:0}.mat-slide-toggle-thumb{height:20px;width:20px;border-radius:50%;display:block}.mat-slide-toggle-bar{position:relative;width:36px;height:14px;flex-shrink:0;border-radius:8px}.mat-slide-toggle-input{bottom:0;left:10px}[dir=rtl] .mat-slide-toggle-input{left:auto;right:10px}.mat-slide-toggle-bar,.mat-slide-toggle-thumb{transition:all 80ms linear;transition-property:background-color;transition-delay:50ms}._mat-animation-noopable .mat-slide-toggle-bar,._mat-animation-noopable .mat-slide-toggle-thumb{transition:none}.mat-slide-toggle .mat-slide-toggle-ripple{position:absolute;top:calc(50% - 20px);left:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-slide-toggle .mat-slide-toggle-ripple .mat-ripple-element:not(.mat-slide-toggle-persistent-ripple){opacity:.12}.mat-slide-toggle-persistent-ripple{width:100%;height:100%;transform:none}.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:.04}.mat-slide-toggle:not(.mat-disabled).cdk-keyboard-focused .mat-slide-toggle-persistent-ripple{opacity:.12}.mat-slide-toggle-persistent-ripple,.mat-slide-toggle.mat-disabled .mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:0}@media(hover: none){.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{display:none}}.mat-slide-toggle-input:focus~.mat-slide-toggle-thumb-container .mat-focus-indicator::before{content:""}.cdk-high-contrast-active .mat-slide-toggle-thumb,.cdk-high-contrast-active .mat-slide-toggle-bar{border:1px solid}'],encapsulation:2,changeDetection:0}),n})(),Rt=(()=>{class n{}return n.\u0275fac=function(a){return new(a||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({}),n})(),Ka=(()=>{class n{}return n.\u0275fac=function(a){return new(a||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[Rt,y.si,y.BQ,kt.Q8,Rt,y.BQ]}),n})();var A,h,Me,it,Qe,K,At,st,St,ot,wt,lt;function $a(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"Schl\xfcssel ist Pflicht"),e.qZA())}function Ba(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"genau 5 Ziffern - nach links mit 0 auff\xfcllen "),e.qZA())}function Va(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"Name ist Pflicht"),e.qZA())}function Xa(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"maximal 100 Zeichen"),e.qZA())}function en(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"maximal 200 Zeichen"),e.qZA())}function tn(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"Quelle ist Pflicht"),e.qZA())}function an(n,t){if(1&n&&(e.TgZ(0,"option",39),e._uU(1),e.qZA()),2&n){const a=t.$implicit;e.Q6J("value",a),e.xp6(1),e.Oqu(a)}}function nn(n,t){if(1&n&&e._UZ(0,"mja-frage-loesung-images",40),2&n){const a=e.oxw().ngIf;e.Q6J("images",a.images)}}function sn(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"Frage ist Pflicht"),e.qZA())}function on(n,t){if(1&n&&(e.TgZ(0,"option",39),e._uU(1),e.qZA()),2&n){const a=t.$implicit;e.Q6J("value",a),e.xp6(1),e.Oqu(a)}}function ln(n,t){if(1&n&&(e.TgZ(0,"div")(1,"h3"),e._uU(2),e.qZA(),e.TgZ(3,"div",41)(4,"div",9)(5,"mat-form-field",10)(6,"mat-label"),e._uU(7,"Text"),e.qZA(),e._UZ(8,"input",42,43),e.TgZ(10,"mat-hint"),e._uU(11,"Text des Antwortvorschlags - Wort oder kurze Wortgruppe"),e.qZA()()(),e.TgZ(12,"div",9)(13,"mat-slide-toggle",44,45),e._uU(15," korrekt (nein/ja)"),e.qZA()()()()),2&n){const a=t.$implicit,i=t.index,o=e.oxw(2);e.xp6(2),e.hij("Antwortvorschlag ",o.getBuchstabe(i),""),e.xp6(1),e.Q6J("formGroup",a)}}function rn(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"Antwortvorschl\xe4ge sind noch fehlerhaft: genau einer muss korrekt sein."),e.qZA())}function cn(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div")(1,"mja-select-items",46),e.NdJ("modelChanged",function(o){e.CHM(a);const c=e.oxw(2);return e.KtG(c.onSelectItemsCompomentModelChanged(o))}),e.qZA()()}if(2&n){const a=e.oxw(2);e.xp6(1),e.Q6J("model",a.selectItemsCompomentModel)}}function dn(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div",33)(1,"button",47),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(2);return e.KtG(o.cancelEdit())}),e._uU(2,"Abbruch/Details"),e.qZA()()}}function mn(n,t){1&n&&(e.TgZ(0,"div",48),e._uU(1," Tja, das kann so noch nicht gespeichert werden. Es gibt noch Validierungsfehler, z.B. fehlende Pflichtangaben und so. "),e.qZA())}function un(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div",3)(1,"h2"),e._uU(2,"R\xe4tseleditor"),e.qZA(),e.TgZ(3,"div",4)(4,"div",5)(5,"mat-label"),e._uU(6,"ID:"),e.qZA()(),e.TgZ(7,"div",6),e._uU(8),e.qZA()(),e.TgZ(9,"form",7)(10,"div",8)(11,"div",9)(12,"mat-form-field",10)(13,"mat-label"),e._uU(14,"Schl\xfcssel"),e.qZA(),e._UZ(15,"input",11,12),e.TgZ(17,"mat-hint"),e._uU(18,"genau 5 Ziffern - verwendet als Dateiname f\xfcr generierte Bilder"),e.qZA(),e.YNc(19,$a,2,0,"mat-error",13),e.YNc(20,Ba,2,0,"mat-error",13),e.qZA()(),e.TgZ(21,"div",9)(22,"mat-form-field",10)(23,"mat-label"),e._uU(24,"Name"),e.qZA(),e._UZ(25,"input",14,15),e.TgZ(27,"mat-hint"),e._uU(28,"wird in der Trefferliste angezeigt"),e.qZA(),e.YNc(29,Va,2,0,"mat-error",13),e.YNc(30,Xa,2,0,"mat-error",13),e.qZA()(),e.TgZ(31,"div",9)(32,"mat-form-field",10)(33,"mat-label"),e._uU(34,"Kommentar"),e.qZA(),e._UZ(35,"input",16,17),e.TgZ(37,"mat-hint"),e._uU(38,"Kommentare sind in Volltextsuche eingebunden"),e.qZA(),e.YNc(39,en,2,0,"mat-error",13),e.qZA()(),e.TgZ(40,"div",8)(41,"div",18)(42,"mat-form-field",10)(43,"mat-label"),e._uU(44,"ID der Quelle"),e.qZA(),e._UZ(45,"input",19,20),e.TgZ(47,"mat-hint"),e._uU(48),e.qZA(),e.YNc(49,tn,2,0,"mat-error",13),e.qZA()()(),e.TgZ(50,"div",9)(51,"mat-form-field",10)(52,"mat-label"),e._uU(53,"Status"),e.qZA(),e.TgZ(54,"select",21,22),e.YNc(56,an,2,2,"option",23),e.qZA()()(),e.YNc(57,nn,1,1,"mja-frage-loesung-images",24),e.TgZ(58,"div",9)(59,"mat-form-field",10)(60,"mat-label"),e._uU(61,"Frage"),e.qZA(),e._UZ(62,"textarea",25,26),e.TgZ(65,"mat-hint"),e._uU(66,"LaTeX-Schnipsel ohne Pr\xe4ambel und document-Umgebung"),e.qZA(),e.YNc(67,sn,2,0,"mat-error",13),e.qZA()(),e.TgZ(68,"div",9)(69,"mat-form-field",10)(70,"mat-label"),e._uU(71,"L\xf6sung"),e.qZA(),e._UZ(72,"textarea",27,28),e.TgZ(75,"mat-hint"),e._uU(76,"LaTeX-Schnipsel ohne Pr\xe4ambel und document-Umgebung"),e.qZA()()(),e.TgZ(77,"div",9)(78,"mat-form-field",10)(79,"mat-label"),e._uU(80,"Anzahl Antwortvorschl\xe4ge"),e.qZA(),e.TgZ(81,"select",29,30),e.NdJ("change",function(o){e.CHM(a);const c=e.oxw();return e.KtG(c.onChangeAnzahlAntwortvorschlaege(o))}),e.YNc(83,on,2,2,"option",23),e.qZA()()()(),e.YNc(84,ln,16,2,"div",31),e.YNc(85,rn,2,0,"mat-error",13),e.qZA(),e.YNc(86,cn,2,1,"div",13),e.TgZ(87,"div",32)(88,"div",33)(89,"button",34),e.NdJ("click",function(){e.CHM(a);const o=e.oxw();return e.KtG(o.submit())}),e._uU(90,"speichern"),e.qZA()(),e.TgZ(91,"div",33)(92,"button",35),e.NdJ("click",function(){e.CHM(a);const o=e.oxw();return e.KtG(o.openPrintPNGDialog())}),e._uU(93,"PNG generieren"),e.qZA()(),e.YNc(94,dn,3,0,"div",36),e.TgZ(95,"div",33)(96,"button",37),e.NdJ("click",function(){e.CHM(a);const o=e.oxw();return e.KtG(o.gotoSuche())}),e._uU(97,"R\xe4tselsuche"),e.qZA()()(),e.YNc(98,mn,2,0,"div",38),e.qZA()}if(2&n){const a=t.ngIf,i=e.oxw(),o=e.MAs(5);e.xp6(8),e.Oqu(a.id),e.xp6(1),e.Q6J("formGroup",i.form),e.xp6(10),e.Q6J("ngIf",i.raetselDataError("schluessel","required")),e.xp6(1),e.Q6J("ngIf",i.raetselDataError("schluessel","pattern")),e.xp6(9),e.Q6J("ngIf",i.raetselDataError("name","required")),e.xp6(1),e.Q6J("ngIf",i.raetselDataError("name","maxLength")),e.xp6(9),e.Q6J("ngIf",i.raetselDataError("kommentar","maxLength")),e.xp6(9),e.Oqu(a.quelle.name),e.xp6(1),e.Q6J("ngIf",i.raetselDataError("quelleId","required")),e.xp6(7),e.Q6J("ngForOf",i.selectStatusInput),e.xp6(1),e.Q6J("ngIf",a.images)("ngIfElse",o),e.xp6(5),e.Q6J("cdkAutosizeMinRows",5)("cdkAutosizeMaxRows",15),e.xp6(5),e.Q6J("ngIf",i.raetselDataError("frage","required")),e.xp6(5),e.Q6J("cdkAutosizeMinRows",5)("cdkAutosizeMaxRows",15),e.xp6(11),e.Q6J("ngForOf",i.anzahlenAntwortvorschlaege),e.xp6(1),e.Q6J("ngForOf",i.antwortvorschlaegeFormGroup),e.xp6(1),e.Q6J("ngIf",i.antwortvorschlaegeErrors()),e.xp6(1),e.Q6J("ngIf",i.selectItemsCompomentModel),e.xp6(3),e.Q6J("disabled",!i.form.valid||i.antwortvorschlaegeErrors()),e.xp6(3),e.Q6J("disabled",i.generierenDiabled()),e.xp6(2),e.Q6J("ngIf","neu"!==a.id),e.xp6(4),e.Q6J("ngIf",!i.form.valid||i.antwortvorschlaegeErrors())}}function _n(n,t){1&n&&(e.TgZ(0,"h2"),e._uU(1,"R\xe4tseleditor"),e.qZA(),e.TgZ(2,"p"),e._uU(3,"kein R\xe4tsel ausgew\xe4hlt"),e.qZA())}function pn(n,t){1&n&&(e.TgZ(0,"p"),e._uU(1,"noch keine Images generiert"),e.qZA())}class se{constructor(){A.add(this),h.set(this,void 0),Me.set(this,(0,e.f3M)(u.QS)),it.set(this,(0,e.f3M)(Pe.CI)),Qe.set(this,new v.w0),K.set(this,[]),this.anzahlenAntwortvorschlaege=["0","2","3","5","6"],this.selectStatusInput=["ERFASST","FREIGEGEBEN"],this.dialog=(0,e.f3M)(Te.uw),this.raetselFacade=(0,e.f3M)(S),this.grafikFacade=(0,e.f3M)(D),this.raetselDataError=(t,a)=>this.form.controls[t].hasError(a),this.form=(0,s.Q_)(this,Me,"f").group({schluessel:["",[u.kI.required,u.kI.pattern("^[0-9]{5}$")]],name:["",[u.kI.required,u.kI.maxLength(100)]],quelleId:["",[u.kI.required]],status:["",[u.kI.required]],frage:["",[u.kI.required]],loesung:[""],kommentar:[""],anzahlAntwortvorschlaege:["0"],antwortvorschlaege:new u.vC([])})}ngOnInit(){(0,s.YH)(this,Qe,(0,pt.a)([this.raetselFacade.raetselDetails$,(0,s.Q_)(this,it,"f").alleDeskriptoren$]).subscribe(([t,a])=>{(0,s.YH)(this,h,{...t},"f"),(0,s.YH)(this,K,(0,s.Q_)(this,h,"f").deskriptoren,"f"),this.selectItemsCompomentModel=this.raetselFacade.initSelectItemsCompomentModel((0,s.Q_)(this,h,"f").deskriptoren,a),(0,s.Q_)(this,A,"m",At).call(this)}),"f")}ngOnDestroy(){(0,s.Q_)(this,Qe,"f").unsubscribe()}isFormValid(){return!!this.form.valid}getBuchstabe(t){switch(t){case 0:return"A";case 1:return"B";case 2:return"C";case 3:return"D";case 4:return"E";case 5:return"F"}return""}get avFormArray(){return this.form.controls.antwortvorschlaege}get antwortvorschlaegeFormGroup(){return this.avFormArray.controls}antwortvorschlaegeErrors(){const t=(0,s.Q_)(this,A,"m",ot).call(this);if(0===t.length)return!1;let a=0;return t.forEach(i=>{i.korrekt&&a++}),1!==a}generierenDiabled(){const t=(0,s.Q_)(this,h,"f").grafikInfos.filter(a=>!a.existiert);return!this.form.valid||this.antwortvorschlaegeErrors()||t.length>0}onChangeAnzahlAntwortvorschlaege(t){const a=parseInt(t.target.value);(0,s.Q_)(this,A,"m",st).call(this,a)}onSelectItemsCompomentModelChanged(t){if(t){const a=t.gewaehlteItems;(0,s.YH)(this,K,[],"f"),a.forEach(i=>(0,s.Q_)(this,K,"f").push({id:i.id,name:i.name}))}}cancelEdit(){(0,s.Q_)(this,h,"f")&&"neu"!==(0,s.Q_)(this,h,"f").id?this.raetselFacade.selectRaetsel((0,s.Q_)(this,h,"f")):this.raetselFacade.cancelSelection()}gotoSuche(){this.raetselFacade.cancelSelection()}openPrintPNGDialog(){const t={titel:"PNG generieren",layoutsAntwortvorschlaegeInput:b.fq,selectedLayoutAntwortvorschlaege:void 0};this.dialog.open(E.v4,{height:"300px",width:"700px",data:t}).afterClosed().subscribe(i=>{if(i&&t.selectedLayoutAntwortvorschlaege){let o="NOOP";switch(t.selectedLayoutAntwortvorschlaege){case"ANKREUZTABELLE":o="ANKREUZTABELLE";break;case"BUCHSTABEN":o="BUCHSTABEN";break;case"DESCRIPTION":o="DESCRIPTION"}this.raetselFacade.generiereRaetselOutput((0,s.Q_)(this,h,"f").id,"PNG",o)}})}openHistorieLaTeXSpeichernDialog(t){this.dialog.open(E.Tb,{height:"300px",width:"700px",data:{frage:"Soll Historie gespeichert werden?",hinweis:"Bitte nur bei inhaltlichen Korrekturen. Das spart Speicherplatz"}}).afterClosed().subscribe(o=>{(0,s.Q_)(this,A,"m",lt).call(this,t,o)})}submit(){const t=(0,s.Q_)(this,A,"m",St).call(this);(0,s.Q_)(this,A,"m",wt).call(this,t)?this.openHistorieLaTeXSpeichernDialog(t):(0,s.Q_)(this,A,"m",lt).call(this,t,!1)}grafikLaden(t){this.grafikFacade.grafikPruefen(t)}onGrafikHochgeladen(t){}}h=new WeakMap,Me=new WeakMap,it=new WeakMap,Qe=new WeakMap,K=new WeakMap,A=new WeakSet,At=function(){const t=(0,s.Q_)(this,h,"f");this.form.controls.schluessel.setValue(t.schluessel),this.form.controls.name.setValue(t.name),this.form.controls.quelleId.setValue(t.quelle.id),this.form.controls.status.setValue(t.status),this.form.controls.frage.setValue(t.frage),this.form.controls.loesung.setValue(t.loesung),this.form.controls.kommentar.setValue(t.kommentar),this.form.controls.anzahlAntwortvorschlaege.setValue(t.antwortvorschlaege.length+""),(0,s.Q_)(this,A,"m",st).call(this,t.antwortvorschlaege.length);for(let a=0;a<t.antwortvorschlaege.length;a++){const i=this.avFormArray.at(a),o=t.antwortvorschlaege[a];i.setValue({text:o.text,korrekt:o.korrekt})}},st=function(t){if(this.avFormArray.length<t)for(let a=this.avFormArray.length;a<t;a++)this.avFormArray.push((0,s.Q_)(this,Me,"f").group({text:["",[u.kI.required,u.kI.maxLength(30)]],korrekt:[!1,[u.kI.required]]}));else for(let a=this.avFormArray.length;a>=t;a--)this.avFormArray.removeAt(a)},St=function(){const t=this.form.value,a=(0,s.Q_)(this,A,"m",ot).call(this);return{...(0,s.Q_)(this,h,"f"),schluessel:t.schluessel.trim(),name:null!==t.name?t.name.trim():"",status:t.status,kommentar:null!==t.kommentar?t.kommentar.trim():null,frage:null!==t.frage?t.frage.trim():"",loesung:null!==t.loesung?t.loesung.trim():null,antwortvorschlaege:a,deskriptoren:(0,s.Q_)(this,K,"f"),images:null}},ot=function(){const t=[];for(let a=0;a<this.avFormArray.length;a++){const i=this.avFormArray.at(a).value;t.push({buchstabe:this.getBuchstabe(a),text:i.text.trim(),korrekt:i.korrekt})}return t},wt=function(t){return"neu"!==(0,s.Q_)(this,h,"f").id&&(t.frage!==(0,s.Q_)(this,h,"f").frage||t.loesung!==(0,s.Q_)(this,h,"f").loesung)},lt=function(t,a){this.raetselFacade.saveRaetsel({latexHistorisieren:a,raetsel:t})},se.\u0275fac=function(t){return new(t||se)},se.\u0275cmp=e.Xpm({type:se,selectors:[["mja-raetsel-editor"]],standalone:!0,features:[e.jDz],decls:6,vars:4,consts:[["class","container",4,"ngIf","ngIfElse"],["keinRaetsel",""],["keineImagesGeneriert",""],[1,"container"],["fxLayout","row wrap","fxLayoutGap","20px","fxLayoutAlign","flex-start"],["fxFlex","0 1 calc(10%-20px)"],["fxFlex","0 1 calc(90%-20px)",1,"mb-1"],["novalidate","",3,"formGroup"],["fxLayout","column wrap","fxLayoutGap","10px","fxLayoutAlign","flex-start"],[1,"mb-2"],["appearance","fill",1,"form-box"],["matInput","","maxlength","5","inputmode","tel","placeholder","schluessel","formControlName","schluessel"],["schluesselInput",""],[4,"ngIf"],["matInput","","maxlength","100","placeholder","name","formControlName","name"],["nameInput",""],["matInput","","maxlength","200","placeholder","Kommentar","formControlName","kommentar"],["kommentarInput",""],[1,"mb-2","row"],["matInput","","maxlength","36","placeholder","Quelle","formControlName","quelleId"],["quelleIdInput",""],["matNativeControl","","formControlName","status"],["statusInput",""],[3,"value",4,"ngFor","ngForOf"],[3,"images",4,"ngIf","ngIfElse"],["matInput","","cdkTextareaAutosize","","placeholder","Frage","formControlName","frage",3,"cdkAutosizeMinRows","cdkAutosizeMaxRows"],["autosize","cdkTextareaAutosize","frageInput",""],["matInput","","cdkTextareaAutosize","","placeholder","L\xf6sung","formControlName","loesung",3,"cdkAutosizeMinRows","cdkAutosizeMaxRows"],["autosize","cdkTextareaAutosize","loesungInput",""],["matNativeControl","","formControlName","anzahlAntwortvorschlaege",3,"change"],["anzahlAntwortvorschlaegeInput",""],[4,"ngFor","ngForOf"],["flex","","fxLayout","row","fxLayoutGap","10px","fxLayout.lt-sm","column"],["fxLayoutAlign","left center","fxFlex","20"],["fxFlexFill","","mat-raised-button","","color","primary",3,"disabled","click"],["fxFlexFill","","mat-raised-button","","color","primary","matTooltip","PNG Frage und L\xf6sung generieren",3,"disabled","click"],["fxLayoutAlign","left center","fxFlex","20",4,"ngIf"],["fxFlexFill","","mat-raised-button","","color","primary","matTooltip","zur\xfcck zur Suche",3,"click"],["class","hint-red mt-1 mb-2",4,"ngIf"],[3,"value"],[3,"images"],[3,"formGroup"],["matInput","","maxlength","30","placeholder","Text","formControlName","text"],["textInput",""],["formControlName","korrekt","color","primary"],["korrektInput",""],[3,"model","modelChanged"],["fxFlexFill","","mat-raised-button","","color","primary","matTooltip","zur\xfcck zur Detailansicht",3,"click"],[1,"hint-red","mt-1","mb-2"]],template:function(t,a){if(1&t&&(e.YNc(0,un,99,25,"div",0),e.ALo(1,"async"),e.YNc(2,_n,4,0,"ng-template",null,1,e.W1O),e.YNc(4,pn,2,0,"ng-template",null,2,e.W1O)),2&t){const i=e.MAs(3);e.Q6J("ngIf",e.lcZ(1,2,a.raetselFacade.raetselDetails$))("ngIfElse",i)}},dependencies:[p.ez,p.sg,p.O5,p.Ov,M.ot,M.lW,be.Hi,Te.Is,$.Ps,de.c,Se.IC,w.TO,w.KE,w.bx,w.hX,de.Nt,w.lN,Re.ie,Ka,Tt,Ae.AV,Ae.gM,vt.XD,Se.Ky,le.o9,g.xw,g.SQ,g.Wh,g.s9,g.yH,z.To,u.UX,u._Y,u.YN,u.Kr,u.Fj,u.EJ,u.JJ,u.JL,u.nD,u.sg,u.u,E.GR,E.NJ],styles:["mat-form-field[_ngcontent-%COMP%]{display:block}"]});const fn=[{path:"uebersicht",canActivate:[()=>(0,e.f3M)(J.jE).userIsLoggedIn$],component:Y,providers:[ce,Ze]},{path:"details",canActivate:[()=>(0,e.f3M)(J.jE).userIsLoggedIn$],component:ie,providers:[ce,Ze]},{path:"editor",canActivate:[()=>(0,e.f3M)(J.jE).userIsAdmin$],component:se,providers:[ce,Ze]},{path:"",pathMatch:"full",canActivate:[()=>(0,e.f3M)(J.jE).userIsLoggedIn$],component:Y,providers:[ce,Ze]}]}}]);