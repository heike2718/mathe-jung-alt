"use strict";(self.webpackChunkmja_app=self.webpackChunkmja_app||[]).push([[681],{681:(xn,ct,c)=>{c.r(ct),c.d(ct,{raetselRoutes:()=>vn});var s=c(655),e=c(4650),p=c(6895),X=c(7392),L=c(4859),w=c(7155),Ne=c(8739),le=c(6308),re=c(9814),r=c(9653);const d=(0,r.R7)({source:"Raetsel",events:{RAETSEL_SELECT_PAGE:(0,r.Ky)(),FIND_RAETSEL:(0,r.Ky)(),RAETSEL_FOUND:(0,r.Ky)(),RAETSEL_SELECTED:(0,r.Ky)(),RAETSEL_DETAILS_LOADED:(0,r.Ky)(),GENERATE_RAETSEL_PNG:(0,r.Ky)(),RAETSEL_PNG_GENERATED:(0,r.Ky)(),GENERATE_RAETSEL_PDF:(0,r.Ky)(),LATEX_ERRORS_DETECTED:(0,r.uZ)(),RAETSEL_PDF_GENERATED:(0,r.Ky)(),RAETSELSUCHFILTER_CHANGED:(0,r.Ky)(),RAETSEL_CANCEL_SELECTION:(0,r.uZ)(),RESET_RAETSELSUCHFILTER:(0,r.uZ)(),SAVE_RAETSEL:(0,r.Ky)(),RAETSEL_SAVED:(0,r.Ky)(),FIND_LATEXLOGS:(0,r.Ky)(),LATEXLOGS_FOUND:(0,r.Ky)()}});var x=c(4614);const Ge={suchstring:"",deskriptoren:[]},It={id:"neu",schluessel:"",name:"",status:"ERFASST",schreibgeschuetzt:!0,frage:"",loesung:"",kommentar:"",quelle:x.YU,antwortvorschlaege:[],deskriptoren:[],images:null,raetselPDF:null,grafikInfos:[]};function dt(n){return""===n.suchstring&&0===n.deskriptoren.length}const ft=(0,r.Tz)({name:"raetsel",reducer:(0,r.Lq)({loaded:!1,page:[],paginationState:x.n$,selectableDeskriptoren:[],saveSuccessMessage:void 0,raetselDetails:void 0,raetselSuchfilter:Ge,generateLatexError:!1},(0,r.on)(d.raetsel_select_page,(n,t)=>({...n,generateLatexError:!1,paginationState:{...n.paginationState,pageDefinition:{pageIndex:t.pageDefinition.pageIndex,pageSize:t.pageDefinition.pageSize,sortDirection:t.pageDefinition.sortDirection}}})),(0,r.on)(d.raetselsuchfilter_changed,(n,t)=>({...n,raetselSuchfilter:t.suchfilter,generateLatexError:!1})),(0,r.on)(d.raetsel_found,(n,t)=>({...n,loaded:!0,page:t.treffer.treffer,paginationState:{...n.paginationState,anzahlTreffer:t.treffer.trefferGesamt},raetselDetails:void 0,generateLatexError:!1})),(0,r.on)(d.raetsel_details_loaded,(n,t)=>{const a=[];return t.raetselDetails.deskriptoren.forEach(i=>{a.push({id:i.id,name:i.name,selected:!0})}),{...n,raetselDetails:t.raetselDetails,selectableDeskriptoren:a,generateLatexError:!1}}),(0,r.on)(d.raetsel_png_generated,(n,t)=>{if(n.raetselDetails){const i={...n.raetselDetails,images:{imageFrage:t.images.imageFrage,imageLoesung:t.images.imageLoesung}};return{...n,raetselDetails:i,generatingOutput:!1,generateLatexError:!1}}return{...n}}),(0,r.on)(d.raetsel_saved,(n,t)=>{const a=[];return t.raetselDetails.deskriptoren.forEach(i=>{a.push({id:i.id,name:i.name,selected:!0})}),{...n,raetselDetails:t.raetselDetails,selectableDeskriptoren:a,generateLatexError:!1}}),(0,r.on)(d.reset_raetselsuchfilter,(n,t)=>({...n,loaded:!1,page:[],raetselDetails:void 0,raetselSuchfilter:Ge,generateLatexError:!1})),(0,r.on)(d.raetsel_cancel_selection,(n,t)=>({...n,raetselDetails:void 0,selectableDeskriptoren:[],generateLatexError:!1})),(0,r.on)(d.latex_errors_detected,(n,t)=>({...n,generateLatexError:!0})))}),{selectRaetselState:P}=ft,H={isLoaded:(0,r.P1)(P,n=>n.loaded),page:(0,r.P1)(P,n=>n.page),paginationState:(0,r.P1)(P,n=>n.paginationState),raetselDetails:(0,r.P1)(P,n=>n.raetselDetails),suchfilter:(0,r.P1)(P,n=>n.raetselSuchfilter),generateLatexError:(0,r.P1)(P,n=>n.generateLatexError)};var qe,D,I,pt,C,N,ce,de,fe,Ue=c(6582),_t=c(2527),qt=c(6759),_=c(2655),U=c(4351),q=c(4004),R=c(8505),ut=c(262),mt=c(9646),k=c(529);class J{constructor(){qe.add(this),D.set(this,(0,e.f3M)(k.eN)),I.set(this,"/mja-api/raetsel")}findRaetsel(t,a,i){const o=i.pageIndex*i.pageSize;let l=(new k.LE).set(x.jb,i.pageSize).set(x.wE,o).set(x.wQ,i.sortDirection);a.suchstring&&a.suchstring.trim().length>0&&(l=l.set(x.p6,a.suchstring.trim())),a.deskriptoren.length>0&&(l=l.set(x.GE,(0,s.Q_)(this,qe,"m",pt).call(this,a))),l=l.set(x.kd,"ORDINAL");let f=(0,s.Q_)(this,I,"f")+"/v2";t&&(f=(0,s.Q_)(this,I,"f")+"/admin/v2");const v=(new k.WM).set("Accept","application/json");return(0,s.Q_)(this,D,"f").get(f,{headers:v,params:l})}loadRaetselDetails(t){const a=(0,s.Q_)(this,I,"f")+"/"+t.id+"/v1",i=(new k.WM).set("Accept","application/json");return(0,s.Q_)(this,D,"f").get(a,{headers:i})}generateRaetselPNGs(t,a,i,o){const l=(0,s.Q_)(this,I,"f")+"/PNG/"+t+"/v1",f=(new k.WM).set("Accept","application/json"),v=(new k.LE).set("font",a).set("layoutAntwortvorschlaege",o).set("size",i);return(0,s.Q_)(this,D,"f").post(l,o,{headers:f,params:v})}generateRaetselPDF(t,a,i,o){const l=(0,s.Q_)(this,I,"f")+"/PDF/"+t+"/v1",f=(new k.WM).set("Accept","application/json"),v=(new k.LE).set("font",a).set("layoutAntwortvorschlaege",o).set("size",i);return(0,s.Q_)(this,D,"f").get(l,{headers:f,params:v})}findLatexLogs(t){const a=(0,s.Q_)(this,I,"f")+"/latexlogs/"+t+"/v1",i=(new k.WM).set("Accept","application/json");return(0,s.Q_)(this,D,"f").get(a,{headers:i})}saveRaetsel(t){const a=(0,s.Q_)(this,I,"f")+"/v1",i=(new k.WM).set("Accept","application/json");return"neu"===t.raetsel.id?(0,s.Q_)(this,D,"f").post(a,t,{headers:i}):(0,s.Q_)(this,D,"f").put(a,t,{headers:i})}}D=new WeakMap,I=new WeakMap,qe=new WeakSet,pt=function(t){let a="";for(let i=0;i<t.deskriptoren.length;i++){const o=t.deskriptoren[i];a+=i<t.deskriptoren.length-1?o.id+",":o.id}return a},J.\u0275fac=function(t){return new(t||J)},J.\u0275prov=e.Yz7({token:J,factory:J.\u0275fac,providedIn:"root"});class Y{constructor(){C.set(this,(0,e.f3M)(_.eX)),N.set(this,(0,e.f3M)(J)),ce.set(this,(0,e.f3M)(Ue.F0)),de.set(this,(0,e.f3M)(qt._b)),fe.set(this,(0,e.f3M)(_t.ez)),this.findRaetsel$=(0,_.GW)(()=>(0,s.Q_)(this,C,"f").pipe((0,_.l4)(d.find_raetsel),(0,U.b)(t=>(0,s.Q_)(this,N,"f").findRaetsel(t.admin,t.suchfilter,t.pageDefinition)),(0,q.U)(t=>d.raetsel_found({treffer:t})))),this.raetselSelected$=(0,_.GW)(()=>(0,s.Q_)(this,C,"f").pipe((0,_.l4)(d.raetsel_selected),(0,U.b)(t=>(0,s.Q_)(this,N,"f").loadRaetselDetails(t.raetsel)),(0,q.U)(t=>d.raetsel_details_loaded({raetselDetails:t,navigateTo:"raetsel/details"})))),this.showDetails$=(0,_.GW)(()=>(0,s.Q_)(this,C,"f").pipe((0,_.l4)(d.raetsel_details_loaded),(0,R.b)(t=>{(0,s.Q_)(this,ce,"f").navigateByUrl(t.navigateTo)})),{dispatch:!1}),this.generateRaetselPng$=(0,_.GW)(()=>(0,s.Q_)(this,C,"f").pipe((0,_.l4)(d.generate_raetsel_png),(0,U.b)(t=>(0,s.Q_)(this,N,"f").generateRaetselPNGs(t.raetselID,t.font,t.schriftgroesse,t.layoutAntwortvorschlaege).pipe((0,q.U)(a=>d.raetsel_png_generated({images:a})),(0,ut.K)(()=>(0,mt.of)(d.latex_errors_detected())))))),this.generateRaetselPDF$=(0,_.GW)(()=>(0,s.Q_)(this,C,"f").pipe((0,_.l4)(d.generate_raetsel_pdf),(0,U.b)(t=>(0,s.Q_)(this,N,"f").generateRaetselPDF(t.raetselID,t.font,t.schriftgroesse,t.layoutAntwortvorschlaege).pipe((0,q.U)(a=>d.raetsel_pdf_generated({pdf:a})),(0,ut.K)(()=>(0,mt.of)(d.latex_errors_detected())))))),this.downloadPDF$=(0,_.GW)(()=>(0,s.Q_)(this,C,"f").pipe((0,_.l4)(d.raetsel_pdf_generated),(0,R.b)(t=>{(0,s.Q_)(this,de,"f").downloadPdf(t.pdf.fileData,t.pdf.fileName)})),{dispatch:!1}),this.findLatexLogs$=(0,_.GW)(()=>(0,s.Q_)(this,C,"f").pipe((0,_.l4)(d.find_latexlogs),(0,U.b)(t=>(0,s.Q_)(this,N,"f").findLatexLogs(t.schluessel)),(0,q.U)(t=>d.latexlogs_found({files:t})))),this.latexLogsFound$=(0,_.GW)(()=>(0,s.Q_)(this,C,"f").pipe((0,_.l4)(d.latexlogs_found),(0,R.b)(t=>{t.files.length>0?t.files.forEach(a=>{(0,s.Q_)(this,de,"f").downloadText(a.fileData,a.fileName)}):(0,s.Q_)(this,fe,"f").warn("Logs sind nicht mehr vorhanden")})),{dispatch:!1}),this.cancelSelectiont$=(0,_.GW)(()=>(0,s.Q_)(this,C,"f").pipe((0,_.l4)(d.raetsel_cancel_selection),(0,R.b)(()=>(0,s.Q_)(this,ce,"f").navigateByUrl("raetsel/uebersicht"))),{dispatch:!1}),this.saveRaetsel$=(0,_.GW)(()=>(0,s.Q_)(this,C,"f").pipe((0,_.l4)(d.save_raetsel),(0,U.b)(t=>(0,s.Q_)(this,N,"f").saveRaetsel(t.editRaetselPayload)),(0,q.U)(t=>d.raetsel_saved({raetselDetails:t})))),this.raetselSaved$=(0,_.GW)(()=>(0,s.Q_)(this,C,"f").pipe((0,_.l4)(d.raetsel_saved),(0,R.b)(()=>(0,s.Q_)(this,fe,"f").info("R\xe4tsel erfolgreich gespeichert"))),{dispatch:!1})}}C=new WeakMap,N=new WeakMap,ce=new WeakMap,de=new WeakMap,fe=new WeakMap,Y.\u0275fac=function(t){return new(t||Y)},Y.\u0275prov=e.Yz7({token:Y,factory:Y.\u0275fac,providedIn:"root"});const _e=[(0,r.oY)(ft),(0,_.y3)([Y])];var m,He,Je,Ye,Oe=c(9241),Pe=c(8407);class S{constructor(){m.set(this,(0,e.f3M)(r.yh)),He.set(this,(0,e.f3M)(Ue.F0)),this.loaded$=(0,s.Q_)(this,m,"f").select(H.isLoaded),this.page$=(0,s.Q_)(this,m,"f").select(H.page),this.paginationState$=(0,s.Q_)(this,m,"f").select(H.paginationState),this.raetselDetails$=(0,s.Q_)(this,m,"f").select(H.raetselDetails).pipe(Pe.d0,Pe.I8),this.suchfilter$=(0,s.Q_)(this,m,"f").select(H.suchfilter),this.generateLatexError$=(0,s.Q_)(this,m,"f").select(H.generateLatexError),Je.set(this,(0,e.f3M)(Oe.jf))}triggerSearch(t,a,i){(0,s.Q_)(this,m,"f").dispatch(d.raetsel_select_page({pageDefinition:i})),(0,s.Q_)(this,m,"f").dispatch(d.find_raetsel({admin:t,suchfilter:a,pageDefinition:i}))}selectRaetsel(t){(0,s.Q_)(this,m,"f").dispatch(d.raetsel_selected({raetsel:t}))}generiereRaetselOutput(t,a,i,o,l){switch(a){case"PNG":(0,s.Q_)(this,m,"f").dispatch(d.generate_raetsel_png({raetselID:t,font:i,schriftgroesse:o,layoutAntwortvorschlaege:l}));break;case"PDF":(0,s.Q_)(this,m,"f").dispatch(d.generate_raetsel_pdf({raetselID:t,font:i,schriftgroesse:o,layoutAntwortvorschlaege:l}));break;default:throw new Error("Unbekanntes outputFormat "+a)}}editRaetsel(){(0,s.Q_)(this,He,"f").navigateByUrl("raetsel/editor")}changeSuchfilterWithDeskriptoren(t,a){(0,s.Q_)(this,m,"f").dispatch(d.raetselsuchfilter_changed({suchfilter:{deskriptoren:t,suchstring:a}}))}changeSuchfilterWithSelectableItems(t,a){const i=[];t.forEach(l=>{i.push({id:l.id,name:l.name})});const o={suchstring:a,deskriptoren:i};(0,s.Q_)(this,m,"f").dispatch(d.raetselsuchfilter_changed({suchfilter:o}))}neueRaetselsuche(){(0,s.Q_)(this,m,"f").dispatch(d.reset_raetselsuchfilter()),(0,s.Q_)(this,Je,"f").resetSelection()}cancelSelection(){(0,s.Q_)(this,m,"f").dispatch(d.raetsel_cancel_selection())}createAndEditRaetsel(t){if(void 0===t)return;const a={...It,quelle:t};(0,s.Q_)(this,m,"f").dispatch(d.raetsel_details_loaded({raetselDetails:a,navigateTo:"raetsel/editor"}))}initSelectItemsCompomentModel(t,a){const i=[];t.forEach(f=>i.push({id:f.id,name:f.name,selected:!0}));const o=[];return a.forEach(f=>{t.find(rt=>rt.id===f.id)||o.push({id:f.id,name:f.name,selected:!1})}),{ueberschriftAuswahlliste:"Deskriptoren",ueberschriftGewaehlteItems:"gew\xe4hlt:",vorrat:o,gewaehlteItems:i}}saveRaetsel(t){(0,s.Q_)(this,m,"f").dispatch(d.save_raetsel({editRaetselPayload:t}))}downloadLatexLogs(t){(0,s.Q_)(this,m,"f").dispatch(d.find_latexlogs({schluessel:t}))}}m=new WeakMap,He=new WeakMap,Je=new WeakMap,S.\u0275fac=function(t){return new(t||S)},S.\u0275prov=e.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"});class z{constructor(){Ye.set(this,(0,e.f3M)(S))}connect(t){return(0,s.Q_)(this,Ye,"f").page$}disconnect(t){}}Ye=new WeakMap,z.\u0275fac=function(t){return new(t||z)},z.\u0275prov=e.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"});var ze,We,me,pe,je,vt,b=c(727),gt=c(9841),ht=c(8372),Ot=c(6451),W=c(9777),E=c(9549),ue=c(284),Pt=c(4968),Ht=c(1884),Q=c(3987);const Jt=["input"];class ee{constructor(){ze.add(this),We.set(this,(0,e.f3M)(S)),me.set(this,new b.w0),pe.set(this,new b.w0),je.set(this,new b.w0),this.inputChanged=new e.vpe,this.selectableItemsChanged=new e.vpe}ngAfterViewInit(){(0,s.YH)(this,pe,(0,s.Q_)(this,We,"f").suchfilter$.subscribe(t=>{t&&(this.input.nativeElement.value=t.suchstring)}),"f"),(0,s.YH)(this,me,(0,Pt.R)(this.input.nativeElement,"keyup").pipe((0,ht.b)(300),(0,Ht.x)(),(0,R.b)(()=>{(0,s.Q_)(this,ze,"m",vt).call(this)})).subscribe(),"f")}ngOnDestroy(){(0,s.Q_)(this,me,"f").unsubscribe(),(0,s.Q_)(this,pe,"f").unsubscribe(),(0,s.Q_)(this,je,"f").unsubscribe()}onSelectItemsCompomentModelChanged(t){this.selectableItemsChanged.emit(t)}}We=new WeakMap,me=new WeakMap,pe=new WeakMap,je=new WeakMap,ze=new WeakSet,vt=function(){this.inputChanged.emit(this.input.nativeElement.value)},ee.\u0275fac=function(t){return new(t||ee)},ee.\u0275cmp=e.Xpm({type:ee,selectors:[["mja-raetsel-suchfilter-admin"]],viewQuery:function(t,a){if(1&t&&e.Gf(Jt,5),2&t){let i;e.iGM(i=e.CRH())&&(a.input=i.first)}},inputs:{selectItemsCompomentModel:"selectItemsCompomentModel"},outputs:{inputChanged:"inputChanged",selectableItemsChanged:"selectableItemsChanged"},standalone:!0,features:[e.jDz],decls:9,vars:1,consts:[["matInput","","placeholder","Text",1,"mb-2","p-5"],["input",""],[3,"model","modelChanged"]],template:function(t,a){1&t&&(e.TgZ(0,"h2"),e._uU(1,"Suchfilter"),e.qZA(),e.TgZ(2,"mat-form-field")(3,"mat-label"),e._uU(4,"Text"),e.qZA(),e._UZ(5,"input",0,1),e.qZA(),e.ynx(7),e.TgZ(8,"mja-select-items",2),e.NdJ("modelChanged",function(o){return a.onSelectItemsCompomentModelChanged(o)}),e.qZA(),e.BQk()),2&t&&(e.xp6(8),e.Q6J("model",a.selectItemsCompomentModel))},dependencies:[p.ez,E.lN,E.KE,E.hX,ue.c,ue.Nt,Q.NJ],styles:["mat-form-field[_ngcontent-%COMP%]{display:block}"]});var te,T,Ke,ge,he,ve,xe,ke,Ce,be,Re,ae,ne,Te,xt,$e,g=c(1576);function Yt(n,t){if(1&n){const a=e.EpF();e.ynx(0),e.TgZ(1,"mja-raetsel-suchfilter-admin",21),e.NdJ("inputChanged",function(o){e.CHM(a);const l=e.oxw();return e.KtG(l.onSuchfilterSuchstringChanged(o))})("selectableItemsChanged",function(o){e.CHM(a);const l=e.oxw();return e.KtG(l.onSelectItemsCompomentModelChanged(o))}),e.qZA(),e.TgZ(2,"p"),e._uU(3),e.ALo(4,"json"),e.qZA(),e.BQk()}if(2&n){const a=e.oxw();e.xp6(1),e.Q6J("selectItemsCompomentModel",a.selectItemsCompomentModel),e.xp6(2),e.hij("Suchkriterien: ",e.lcZ(4,2,a.suchfilter),"")}}function zt(n,t){if(1&n){const a=e.EpF();e.ynx(0),e.TgZ(1,"mja-select-items",22),e.NdJ("modelChanged",function(o){e.CHM(a);const l=e.oxw();return e.KtG(l.onSelectItemsCompomentModelChanged(o))}),e.qZA(),e.BQk()}if(2&n){const a=e.oxw();e.xp6(1),e.Q6J("model",a.selectItemsCompomentModel)}}function Wt(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div",2)(1,"button",24),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(2);return e.KtG(o.neuesRaetsel())}),e._uU(2,"neues R\xe4tsel"),e.qZA()()}}function jt(n,t){if(1&n&&(e.ynx(0),e.YNc(1,Wt,3,0,"div",23),e.ALo(2,"async"),e.BQk()),2&n){const a=e.oxw(),i=e.MAs(26);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,a.coreFacade.existsQuelleAdmin$))("ngIfElse",i)}}function Kt(n,t){1&n&&e._UZ(0,"mat-header-cell",25)}function $t(n,t){1&n&&(e.TgZ(0,"span")(1,"mat-icon"),e._uU(2,"block"),e.qZA()())}function Bt(n,t){1&n&&(e.TgZ(0,"span")(1,"mat-icon"),e._uU(2,"check_circle_outline"),e.qZA()())}function Vt(n,t){if(1&n&&(e.TgZ(0,"mat-cell",26),e.YNc(1,$t,3,0,"span",0),e.YNc(2,Bt,3,0,"span",0),e.qZA()),2&n){const a=t.$implicit;e.xp6(1),e.Q6J("ngIf","ERFASST"===a.status),e.xp6(1),e.Q6J("ngIf","FREIGEGEBEN"===a.status)}}function Xt(n,t){if(1&n&&(e.TgZ(0,"mat-header-cell",27),e._uU(1),e.qZA()),2&n){const a=e.oxw();e.xp6(1),e.Oqu(a.getHeaderSchluessel())}}function ea(n,t){if(1&n&&(e.TgZ(0,"mat-cell",28),e._uU(1),e.qZA()),2&n){const a=t.$implicit;e.xp6(1),e.Oqu(a.schluessel)}}function ta(n,t){1&n&&(e.TgZ(0,"mat-header-cell",29),e._uU(1,"Name"),e.qZA())}function aa(n,t){if(1&n&&(e.TgZ(0,"mat-cell",30),e._uU(1),e.qZA()),2&n){const a=t.$implicit;e.xp6(1),e.hij(" ",a.name," ")}}function na(n,t){1&n&&(e.TgZ(0,"mat-header-cell",31),e._uU(1,"Kommentar"),e.qZA())}function ia(n,t){if(1&n&&(e.TgZ(0,"mat-cell",32),e._uU(1),e.qZA()),2&n){const a=t.$implicit;e.xp6(1),e.hij(" ",a.kommentar," ")}}function sa(n,t){1&n&&e._UZ(0,"mat-header-row")}function oa(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"mat-row",33),e.NdJ("click",function(){const l=e.CHM(a).$implicit,f=e.oxw();return e.KtG(f.onRowClicked(l))}),e.qZA()}}function la(n,t){1&n&&(e.TgZ(0,"div",34)(1,"div",35),e._uU(2," zuerst als Autor:in eintragen lassen, dann selbst R\xe4tsel erfassen "),e.qZA()())}const ra=function(){return[20,30,50]};class j{constructor(t){this.changeDetector=t,te.add(this),this.suchfilter=Ge,this.dataSource=(0,e.f3M)(z),this.coreFacade=(0,e.f3M)(Oe.CI),this.isAdmin=!1,this.anzahlRaetsel=0,this.selectItemsCompomentModel=x.Ys,T.set(this,(0,e.f3M)(S)),Ke.set(this,(0,e.f3M)(W.jE)),ge.set(this,void 0),he.set(this,new b.w0),ve.set(this,new b.w0),xe.set(this,new b.w0),ke.set(this,new b.w0),Ce.set(this,new b.w0),be.set(this,new b.w0),Re.set(this,new b.w0),ae.set(this,0),ne.set(this,"asc"),Te.set(this,void 0)}getScreenSize(){(0,s.YH)(this,ge,window.innerWidth,"f")}ngOnInit(){(0,s.YH)(this,he,(0,s.Q_)(this,Ke,"f").user$.pipe((0,R.b)(t=>this.isAdmin=t.isAdmin)).subscribe(),"f"),(0,s.YH)(this,ke,(0,s.Q_)(this,T,"f").paginationState$.subscribe(t=>{this.anzahlRaetsel=t.anzahlTreffer,(0,s.YH)(this,ae,t.pageDefinition.pageIndex,"f"),(0,s.YH)(this,ne,"asc"===t.pageDefinition.sortDirection?"asc":"desc","f")}),"f"),(0,s.YH)(this,Ce,(0,gt.a)([(0,s.Q_)(this,T,"f").suchfilter$,this.coreFacade.alleDeskriptoren$]).subscribe(([t,a])=>{t&&(this.selectItemsCompomentModel=(0,s.Q_)(this,T,"f").initSelectItemsCompomentModel(t.deskriptoren,a))}),"f"),(0,s.YH)(this,be,(0,s.Q_)(this,T,"f").suchfilter$.pipe((0,R.b)(t=>this.suchfilter=t),(0,ht.b)(500),(0,R.b)(()=>{this.paginator&&this.sort&&(0,s.Q_)(this,te,"m",$e).call(this)})).subscribe(),"f"),(0,s.YH)(this,Re,this.coreFacade.quelleAdmin$.subscribe(t=>{(0,s.YH)(this,Te,t,"f")}),"f")}ngOnDestroy(){(0,s.Q_)(this,he,"f").unsubscribe(),(0,s.Q_)(this,ke,"f").unsubscribe(),(0,s.Q_)(this,xe,"f").unsubscribe(),(0,s.Q_)(this,ve,"f").unsubscribe(),(0,s.Q_)(this,Ce,"f").unsubscribe(),(0,s.Q_)(this,be,"f").unsubscribe(),(0,s.Q_)(this,Re,"f").unsubscribe()}ngAfterViewInit(){setTimeout(()=>{},0),(0,s.Q_)(this,te,"m",xt).call(this),(0,s.YH)(this,xe,(0,Ot.T)(this.sort.sortChange,this.paginator.page).pipe((0,R.b)(()=>{dt(this.suchfilter)||(0,s.Q_)(this,te,"m",$e).call(this)})).subscribe(),"f"),this.changeDetector.detectChanges()}getDisplayedColumns(){return this.isAdmin?["status","schluessel","name","kommentar"]:["schluessel","name","kommentar"]}getHeaderSchluessel(){return(0,s.Q_)(this,ge,"f")>959?"SCHLUESSEL":"SCHL"}deskriptorenToString(t){return function Qt(n){if(0===n.length)return"";let t="";for(let a=0;a<n.length;a++){const i=n[a];t+=a<n.length-1?i.name+", ":i.name}return t}(t.deskriptoren)}neueSuche(){(0,s.Q_)(this,T,"f").neueRaetselsuche()}neuesRaetsel(){(0,s.Q_)(this,T,"f").createAndEditRaetsel((0,s.Q_)(this,Te,"f"))}buttonNeueSucheDisabled(){return dt(this.suchfilter)}onRowClicked(t){const a=t;(0,s.Q_)(this,T,"f").selectRaetsel(a)}onSuchfilterSuchstringChanged(t){t.length>=4&&(0,s.Q_)(this,T,"f").changeSuchfilterWithDeskriptoren(this.suchfilter.deskriptoren,t)}onSelectItemsCompomentModelChanged(t){t.gewaehlteItems.length>0&&(0,s.Q_)(this,T,"f").changeSuchfilterWithSelectableItems(t.gewaehlteItems,this.suchfilter.suchstring)}}T=new WeakMap,Ke=new WeakMap,ge=new WeakMap,he=new WeakMap,ve=new WeakMap,xe=new WeakMap,ke=new WeakMap,Ce=new WeakMap,be=new WeakMap,Re=new WeakMap,ae=new WeakMap,ne=new WeakMap,Te=new WeakMap,te=new WeakSet,xt=function(){this.paginator.pageIndex=(0,s.Q_)(this,ae,"f"),this.sort.direction=(0,s.Q_)(this,ne,"f"),(0,s.YH)(this,ve,this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),"f")},$e=function(){const t={pageIndex:this.paginator?this.paginator.pageIndex:(0,s.Q_)(this,ae,"f"),pageSize:this.paginator?this.paginator.pageSize:20,sortDirection:this.sort?this.sort.direction:(0,s.Q_)(this,ne,"f")};(0,s.Q_)(this,T,"f").triggerSearch(this.isAdmin,this.suchfilter,t)},j.\u0275fac=function(t){return new(t||j)(e.Y36(e.sBO))},j.\u0275cmp=e.Xpm({type:j,selectors:[["mja-raetsel-search"]],viewQuery:function(t,a){if(1&t&&(e.Gf(Ne.NW,5),e.Gf(le.YE,5)),2&t){let i;e.iGM(i=e.CRH())&&(a.paginator=i.first),e.iGM(i=e.CRH())&&(a.sort=i.first)}},hostBindings:function(t,a){1&t&&e.NdJ("resize",function(o){return a.getScreenSize(o)},!1,e.Jf7)},standalone:!0,features:[e.jDz],decls:27,vars:11,consts:[[4,"ngIf"],["flex","","fxLayout","row","fxLayoutGap","10px","fxLayout.lt-sm","column",1,"mb-2"],["fxLayoutAlign","left center","fxFlex","10"],["mat-raised-button","","color","primary",3,"disabled","click"],["showFirstLastButtons","",3,"length","pageSizeOptions"],["matSort","","matSortActive","schluessel","matSortDirection","asc","matSortDisableClear","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","status"],["class","mat-header-cell__1",4,"matHeaderCellDef"],["class","mat-cell__1",4,"matCellDef"],["matColumnDef","schluessel"],["mat-sort-header","","class","mat-header-cell__2",4,"matHeaderCellDef"],["class","mat-cell__2",4,"matCellDef"],["matColumnDef","name"],["class","mat-header-cell__3",4,"matHeaderCellDef"],["class","mat-cell__3",4,"matCellDef"],["matColumnDef","kommentar"],["class","mat-header-cell__4",4,"matHeaderCellDef"],["class","mat-cell__4",4,"matCellDef"],[4,"matHeaderRowDef","matHeaderRowDefSticky"],[3,"click",4,"matRowDef","matRowDefColumns"],["keineQuelle",""],[3,"selectItemsCompomentModel","inputChanged","selectableItemsChanged"],[3,"model","modelChanged"],["fxLayoutAlign","left center","fxFlex","10",4,"ngIf","ngIfElse"],["mat-raised-button","","color","primary",3,"click"],[1,"mat-header-cell__1"],[1,"mat-cell__1"],["mat-sort-header","",1,"mat-header-cell__2"],[1,"mat-cell__2"],[1,"mat-header-cell__3"],[1,"mat-cell__3"],[1,"mat-header-cell__4"],[1,"mat-cell__4"],[3,"click"],["fxLayout","column m-1"],["fxFlex","0 1 calc(80%-20px)"]],template:function(t,a){1&t&&(e.TgZ(0,"h1"),e._uU(1,"R\xe4tsel"),e.qZA(),e.YNc(2,Yt,5,4,"ng-container",0),e.YNc(3,zt,2,1,"ng-container",0),e.TgZ(4,"div",1)(5,"div",2)(6,"button",3),e.NdJ("click",function(){return a.neueSuche()}),e._uU(7,"neue Suche"),e.qZA()(),e.YNc(8,jt,3,4,"ng-container",0),e.qZA(),e._UZ(9,"mat-paginator",4),e.TgZ(10,"mat-table",5),e.ynx(11,6),e.YNc(12,Kt,1,0,"mat-header-cell",7),e.YNc(13,Vt,3,2,"mat-cell",8),e.BQk(),e.ynx(14,9),e.YNc(15,Xt,2,1,"mat-header-cell",10),e.YNc(16,ea,2,1,"mat-cell",11),e.BQk(),e.ynx(17,12),e.YNc(18,ta,2,0,"mat-header-cell",13),e.YNc(19,aa,2,1,"mat-cell",14),e.BQk(),e.ynx(20,15),e.YNc(21,na,2,0,"mat-header-cell",16),e.YNc(22,ia,2,1,"mat-cell",17),e.BQk(),e.YNc(23,sa,1,0,"mat-header-row",18),e.YNc(24,oa,1,0,"mat-row",19),e.qZA(),e.YNc(25,la,3,0,"ng-template",null,20,e.W1O)),2&t&&(e.xp6(2),e.Q6J("ngIf",a.isAdmin),e.xp6(1),e.Q6J("ngIf",!a.isAdmin),e.xp6(3),e.Q6J("disabled",a.buttonNeueSucheDisabled()),e.xp6(2),e.Q6J("ngIf",a.isAdmin),e.xp6(1),e.Q6J("length",a.anzahlRaetsel)("pageSizeOptions",e.DdM(10,ra)),e.xp6(1),e.Q6J("dataSource",a.dataSource),e.xp6(13),e.Q6J("matHeaderRowDef",a.getDisplayedColumns())("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",a.getDisplayedColumns()))},dependencies:[p.ez,p.O5,p.Ov,p.Ts,re.o9,g.xw,g.SQ,g.Wh,g.yH,w.p0,w.BZ,w.fO,w.as,w.w1,w.Dz,w.nj,w.ge,w.ev,w.XQ,w.Gk,L.ot,L.lW,Ne.TU,Ne.NW,le.JX,le.YE,le.nU,X.Ps,X.Hw,ee,Q.NJ],styles:[".mat-row[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{border-bottom:1px solid transparent;border-top:1px solid transparent;cursor:pointer}.mat-row[_ngcontent-%COMP%]:hover   .mat-cell[_ngcontent-%COMP%]{border-color:#000;background-color:#f0efef}.mat-header-cell__1[_ngcontent-%COMP%], .mat-cell__1[_ngcontent-%COMP%]{flex:0 1 5%}.mat-header-cell__2[_ngcontent-%COMP%], .mat-cell__2[_ngcontent-%COMP%]{flex:0 1 10%}.mat-header-cell__3[_ngcontent-%COMP%], .mat-cell__3[_ngcontent-%COMP%]{flex:0 1 30%}.mat-header-cell__4[_ngcontent-%COMP%], .mat-cell__4[_ngcontent-%COMP%]{flex:0 1 55%}@media (max-width: 959px){.mat-header-cell__1[_ngcontent-%COMP%], .mat-cell__1[_ngcontent-%COMP%]{flex:0 1 10%}.mat-header-cell__2[_ngcontent-%COMP%], .mat-cell__2[_ngcontent-%COMP%]{flex:0 1 30%}.mat-header-cell__3[_ngcontent-%COMP%], .mat-cell__3[_ngcontent-%COMP%]{flex:0 1 60%}}"]});var Ae=c(7331),we=c(5412),Se=c(4633),Ee=c(266),kt=c(8580),Ze=c(9349),K=c(9652),ca=c(5829);const da=function(n){return{background:n}};let fa=(()=>{class n{isKorrekt(){return this.antwortvorschlag.korrekt}}return n.\u0275fac=function(a){return new(a||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["mja-antwortvorschlag"]],inputs:{antwortvorschlag:"antwortvorschlag"},standalone:!0,features:[e.jDz],decls:5,vars:5,consts:[["fxLayout","row wrap","fxLayoutGap","20px","fxLayoutAlign","flex-start",1,"p-10","bordered",3,"ngStyle"],["fxFlex","0 1 calc(2%-20px)"],["fxFlex","0 1 calc(98%-20px)",1,"mb-1"]],template:function(a,i){1&a&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.qZA(),e.TgZ(3,"div",2),e._uU(4),e.qZA()()),2&a&&(e.Q6J("ngStyle",e.VKq(3,da,i.isKorrekt()?"#d7e6f4":"white")),e.xp6(2),e.hij(" ",i.antwortvorschlag.buchstabe,": "),e.xp6(2),e.Oqu(i.antwortvorschlag.text))},dependencies:[p.ez,p.PC,re.o9,g.xw,g.SQ,g.Wh,g.yH,ca.Zl]}),n})();const Z=(0,r.R7)({source:"Grafik",events:{PRUEFE_GRAFIK:(0,r.Ky)(),GRAFIK_GEPRUEFT:(0,r.Ky)(),GRAFIK_HOCHGELADEN:(0,r.Ky)(),CLEAR_VORSCHAU:(0,r.uZ)()}}),Ct=(0,r.Tz)({name:"grafik",reducer:(0,r.Lq)({loaded:!1,pfad:void 0,selectedGrafikSearchResult:void 0},(0,r.on)(Z.pruefe_grafik,(n,t)=>({...n,selectedGrafikSearchResult:void 0})),(0,r.on)(Z.grafik_geprueft,(n,t)=>({...n,loaded:!0,selectedGrafikSearchResult:t.grafikSearchResult})),(0,r.on)(Z.grafik_hochgeladen,(n,t)=>({...n,loaded:!1,selectedGrafikSearchResult:void 0})),(0,r.on)(Z.clear_vorschau,(n,t)=>({...n,loaded:!1,selectedGrafikSearchResult:void 0})))}),{selectGrafikState:Be}=Ct,bt={isLoaded:(0,r.P1)(Be,n=>n.loaded),grafikPfad:(0,r.P1)(Be,n=>n.pfad),selectedGrafikSearchResult:(0,r.P1)(Be,n=>n.selectedGrafikSearchResult)};var Ve,Xe,De,et,tt,O;class ${constructor(){Ve.set(this,(0,e.f3M)(k.eN)),Xe.set(this,"/mja-api/grafiken/v1")}loadGrafik(t){const a=(new k.WM).set("Accept","application/json");let i=new k.LE;return i=i.set("pfad",t),(0,s.Q_)(this,Ve,"f").get((0,s.Q_)(this,Xe,"f"),{headers:a,params:i})}}Ve=new WeakMap,Xe=new WeakMap,$.\u0275fac=function(t){return new(t||$)},$.\u0275prov=e.Yz7({token:$,factory:$.\u0275fac,providedIn:"root"});class B{constructor(){De.set(this,(0,e.f3M)(_.eX)),et.set(this,(0,e.f3M)($)),tt.set(this,(0,e.f3M)(_t.ez)),this.pruefeGrafik$=(0,_.GW)(()=>(0,s.Q_)(this,De,"f").pipe((0,_.l4)(Z.pruefe_grafik),(0,U.b)(t=>(0,s.Q_)(this,et,"f").loadGrafik(t.pfad)),(0,q.U)(t=>Z.grafik_geprueft({grafikSearchResult:t})))),this.grafikHochgeladen$=(0,_.GW)(()=>(0,s.Q_)(this,De,"f").pipe((0,_.l4)(Z.grafik_hochgeladen),(0,R.b)(t=>{(0,s.Q_)(this,tt,"f").message(t.message)})),{dispatch:!1})}}De=new WeakMap,et=new WeakMap,tt=new WeakMap,B.\u0275fac=function(t){return new(t||B)},B.\u0275prov=e.Yz7({token:B,factory:B.\u0275fac,providedIn:"root"});class M{constructor(){O.set(this,(0,e.f3M)(r.yh)),this.isLoaded$=(0,s.Q_)(this,O,"f").select(bt.isLoaded),this.grafikSearchResult$=(0,Pe.d0)((0,s.Q_)(this,O,"f").select(bt.selectedGrafikSearchResult))}grafikPruefen(t){(0,s.Q_)(this,O,"f").dispatch(Z.pruefe_grafik({pfad:t}))}grafikHochgeladen(t){(0,s.Q_)(this,O,"f").dispatch(Z.grafik_hochgeladen({message:t}))}handleUploadError(t){}clearVorschau(){(0,s.Q_)(this,O,"f").dispatch(Z.clear_vorschau())}}O=new WeakMap,M.\u0275fac=function(t){return new(t||M)},M.\u0275prov=e.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"});const Ie=[(0,r.oY)(Ct),(0,_.y3)([B])];var y,Qe,Me,at,ye,F,nt;function ga(n,t){if(1&n&&(e.TgZ(0,"div",8),e._uU(1),e.qZA()),2&n){const a=e.oxw().ngIf;e.xp6(1),e.AsE(" ",a.pfad,": ",a.messagePayload.message," ")}}function ha(n,t){if(1&n&&(e.TgZ(0,"div",10),e._UZ(1,"img",11),e.qZA()),2&n){const a=e.oxw(2).ngIf;e.xp6(1),e.MGl("src","data:image/png;base64,",a.image,"",e.LSH)}}function va(n,t){if(1&n&&(e.TgZ(0,"div",8),e._uU(1),e.YNc(2,ha,2,1,"div",9),e.qZA()),2&n){const a=e.oxw().ngIf;e.xp6(1),e.hij(" ",a.pfad,": Alles gut: Grafik ist schon hochgeladen. "),e.xp6(1),e.Q6J("ngIf",null!==a.image)}}function xa(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div")(1,"mja-file-upload",12),e.NdJ("dateiAusgewaehlt",function(o){e.CHM(a);const l=e.oxw(3);return e.KtG(l.onDateiAusgewaehlt(o))})("responsePayload",function(o){e.CHM(a);const l=e.oxw(3);return e.KtG(l.onResponse(o))}),e.qZA()()}if(2&n){const a=e.oxw(3);e.xp6(1),e.Q6J("uploadModel",a.uploadModel)}}function ka(n,t){if(1&n){const a=e.EpF();e.ynx(0),e.YNc(1,ga,2,2,"div",4),e.YNc(2,va,3,2,"div",4),e.YNc(3,xa,2,1,"div",3),e.TgZ(4,"div",5)(5,"div",6)(6,"button",7),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(2);return e.KtG(o.reset())}),e._uU(7,"leeren"),e.qZA()()(),e.BQk()}if(2&n){const a=t.ngIf,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf","INFO"!==a.messagePayload.level),e.xp6(1),e.Q6J("ngIf","INFO"===a.messagePayload.level),e.xp6(1),e.Q6J("ngIf",""!==i.uploadModel.pfad)}}function Ca(n,t){if(1&n&&(e.TgZ(0,"div",2),e.YNc(1,ka,8,3,"ng-container",3),e.ALo(2,"async"),e.qZA()),2&n){const a=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,a.grafikFacade.grafikSearchResult$))}}function ba(n,t){1&n&&(e.TgZ(0,"p"),e._uU(1,"zum Pr\xfcfen auf info klicken"),e.qZA())}class ie{constructor(){this.grafikFacade=(0,e.f3M)(M),this.responsePayload=new e.vpe,this.uploadModel={pfad:"",titel:"Grafik hochladen",maxSizeBytes:2097152,errorMessageSize:"Die Datei ist zu gro\xdf. Die maximale erlaubte Gr\xf6\xdfe ist 2 MB.",accept:".eps",acceptMessage:"erlaubte Dateitypen: eps"},this.grafikSelected=!1,y.set(this,(0,e.f3M)(M)),Qe.set(this,new b.w0)}ngOnInit(){(0,s.YH)(this,Qe,(0,s.Q_)(this,y,"f").grafikSearchResult$.subscribe(t=>{t&&(this.uploadModel={...this.uploadModel,pfad:t.pfad},this.grafikSelected=!0)}),"f")}ngOnDestroy(){(0,s.Q_)(this,y,"f").clearVorschau(),(0,s.Q_)(this,Qe,"f").unsubscribe()}onDateiAusgewaehlt(t){}onResponse(t){if(t){const a=this.uploadModel.pfad+": "+t.message,i={...t,message:a};"INFO"===i.level&&((0,s.Q_)(this,y,"f").grafikHochgeladen(i),(0,s.Q_)(this,y,"f").grafikPruefen(this.uploadModel.pfad)),(0,s.Q_)(this,y,"f").grafikHochgeladen(i),(0,s.Q_)(this,y,"f").grafikPruefen(this.uploadModel.pfad),this.responsePayload.emit({level:t.level,message:this.uploadModel.pfad})}}reset(){this.grafikSelected=!1,this.uploadModel={...this.uploadModel,pfad:""},(0,s.Q_)(this,y,"f").clearVorschau()}}function Ra(n,t){if(1&n&&(e.TgZ(0,"div")(1,"mat-chip"),e._uU(2),e.qZA()()),2&n){const a=t.$implicit;e.xp6(2),e.Oqu(a.name)}}function Ta(n,t){if(1&n&&e._UZ(0,"mja-frage-loesung-images",8),2&n){const a=e.oxw().ngIf;e.Q6J("images",a.images)}}function Aa(n,t){if(1&n&&(e.TgZ(0,"div"),e._UZ(1,"mja-antwortvorschlag",10),e.qZA()),2&n){const a=t.$implicit;e.xp6(1),e.Q6J("antwortvorschlag",a)}}function wa(n,t){if(1&n&&(e.TgZ(0,"div")(1,"mat-accordion")(2,"mat-expansion-panel")(3,"mat-expansion-panel-header")(4,"mat-panel-title"),e._uU(5," Antwortvorschl\xe4ge "),e.qZA()(),e.TgZ(6,"div",9),e.YNc(7,Aa,2,1,"div",6),e.qZA()()()()),2&n){const a=e.oxw().ngIf;e.xp6(7),e.Q6J("ngForOf",a.antwortvorschlaege)}}function Sa(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div")(1,"div",11)(2,"div",12)(3,"button",13),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(3);return e.KtG(o.gotoRaetselUebersicht())}),e._uU(4,"Suche"),e.qZA()()()()}}function Ea(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div",12)(1,"button",13),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(4);return e.KtG(o.startEdit())}),e._uU(2,"bearbeiten"),e.qZA()()}}function Za(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div",12)(1,"button",21),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(4);return e.KtG(o.printPNG())}),e._uU(2,"PNG generieren"),e.qZA()()}if(2&n){const a=e.oxw(4);e.xp6(1),e.Q6J("disabled",a.generierenDiabled())}}function Da(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div",12)(1,"button",13),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(4);return e.KtG(o.downloadLatexLogs())}),e._uU(2,"LaTeX-Logs"),e.qZA()()}}function Ia(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"mat-list-item"),e._uU(1),e.TgZ(2,"button",23),e.NdJ("click",function(){const l=e.CHM(a).$implicit,f=e.oxw(5);return e.KtG(f.grafikLaden(l.pfad))}),e.TgZ(3,"mat-icon"),e._uU(4,"info"),e.qZA()()()}if(2&n){const a=t.$implicit;e.xp6(1),e.hij(" ",a.pfad," ")}}function Qa(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"mat-panel-title"),e._uU(3," Grafiken "),e.qZA()(),e.TgZ(4,"mat-nav-list"),e.YNc(5,Ia,5,1,"mat-list-item",6),e.qZA(),e.TgZ(6,"mja-grafik",22),e.NdJ("responsePayload",function(o){e.CHM(a);const l=e.oxw(4);return e.KtG(l.onGrafikHochgeladen(o))}),e.qZA()()}if(2&n){const a=e.oxw(2).ngIf;e.xp6(5),e.Q6J("ngForOf",a.grafikInfos)}}function Ma(n,t){if(1&n&&(e.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"mat-panel-title"),e._uU(3," L\xf6sung (LaTeX) "),e.qZA()(),e.TgZ(4,"textarea",19,20),e._uU(6),e.qZA()()),2&n){const a=e.oxw(2).ngIf;e.xp6(6),e.Oqu(a.loesung)}}function ya(n,t){if(1&n&&(e.TgZ(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"mat-panel-title"),e._uU(3," Kommentar "),e.qZA()(),e.TgZ(4,"textarea",19,20),e._uU(6),e.qZA()()),2&n){const a=e.oxw(2).ngIf;e.xp6(6),e.Oqu(a.kommentar)}}function Fa(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div")(1,"h2"),e._uU(2,"Metadaten und LaTeX"),e.qZA(),e.TgZ(3,"div",11),e.YNc(4,Ea,3,0,"div",14),e.YNc(5,Za,3,1,"div",14),e.TgZ(6,"div",12)(7,"button",15),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(3);return e.KtG(o.printPDF())}),e._uU(8,"PDF generieren"),e.qZA()(),e.YNc(9,Da,3,0,"div",14),e.ALo(10,"async"),e.TgZ(11,"div",12)(12,"button",16),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(3);return e.KtG(o.gotoRaetselUebersicht())}),e._uU(13,"R\xe4tselsuche"),e.qZA()()(),e.TgZ(14,"div",17)(15,"div",11)(16,"div",12)(17,"mat-label"),e._uU(18,"ID:"),e.qZA()(),e.TgZ(19,"div",18),e._uU(20),e.qZA()(),e.TgZ(21,"div",11)(22,"div",12)(23,"mat-label"),e._uU(24,"Name:"),e.qZA()(),e.TgZ(25,"div",18),e._uU(26),e.qZA()(),e.TgZ(27,"div",11)(28,"div",12)(29,"mat-label"),e._uU(30,"Quelle:"),e.qZA()(),e.TgZ(31,"div",18),e._uU(32),e.qZA()(),e.TgZ(33,"div",11)(34,"div",12)(35,"mat-label"),e._uU(36,"Status:"),e.qZA()(),e.TgZ(37,"div",18),e._uU(38),e.qZA()()(),e.TgZ(39,"mat-accordion"),e.YNc(40,Qa,7,1,"mat-expansion-panel",0),e.TgZ(41,"mat-expansion-panel")(42,"mat-expansion-panel-header")(43,"mat-panel-title"),e._uU(44," Frage (LaTeX) "),e.qZA()(),e.TgZ(45,"textarea",19,20),e._uU(47),e.qZA()(),e.YNc(48,Ma,7,1,"mat-expansion-panel",0),e.YNc(49,ya,7,1,"mat-expansion-panel",0),e.qZA()()}if(2&n){const a=e.oxw().ngIf,i=e.oxw(2);e.xp6(4),e.Q6J("ngIf",!a.schreibgeschuetzt),e.xp6(1),e.Q6J("ngIf",!a.schreibgeschuetzt),e.xp6(2),e.Q6J("disabled",i.generierenDiabled()),e.xp6(2),e.Q6J("ngIf",e.lcZ(10,12,i.raetselFacade.generateLatexError$)),e.xp6(11),e.Oqu(a.id),e.xp6(6),e.Oqu(a.name),e.xp6(6),e.Oqu(a.quelle.name),e.xp6(6),e.Oqu(a.status),e.xp6(2),e.Q6J("ngIf",0!==a.grafikInfos.length),e.xp6(7),e.Oqu(a.frage),e.xp6(1),e.Q6J("ngIf",a.loesung),e.xp6(1),e.Q6J("ngIf",a.kommentar)}}function La(n,t){if(1&n&&(e.TgZ(0,"div",3)(1,"h1"),e._uU(2),e.qZA(),e.TgZ(3,"div",4)(4,"div",5)(5,"mat-chip-list"),e.YNc(6,Ra,3,1,"div",6),e.qZA()()(),e.YNc(7,Ta,1,1,"mja-frage-loesung-images",7),e.YNc(8,wa,8,1,"div",0),e.YNc(9,Sa,5,0,"div",0),e.YNc(10,Fa,50,14,"div",0),e.qZA()),2&n){const a=t.ngIf,i=e.oxw().ngIf;e.xp6(2),e.hij("R\xe4tsel ",a.schluessel,""),e.xp6(4),e.Q6J("ngForOf",a.deskriptoren),e.xp6(1),e.Q6J("ngIf",a.images),e.xp6(1),e.Q6J("ngIf",a.antwortvorschlaege.length>0),e.xp6(1),e.Q6J("ngIf",!i.isAdmin),e.xp6(1),e.Q6J("ngIf",i.isAdmin)}}function Na(n,t){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,La,11,6,"div",2),e.ALo(2,"async"),e.qZA()),2&n){const a=e.oxw(),i=e.MAs(3);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,a.raetselFacade.raetselDetails$))("ngIfElse",i)}}function Ga(n,t){1&n&&(e.TgZ(0,"h1"),e._uU(1,"R\xe4tsel Details"),e.qZA(),e.TgZ(2,"p"),e._uU(3,"kein R\xe4tsel gew\xe4hlt"),e.qZA())}y=new WeakMap,Qe=new WeakMap,ie.\u0275fac=function(t){return new(t||ie)},ie.\u0275cmp=e.Xpm({type:ie,selectors:[["mja-grafik"]],outputs:{responsePayload:"responsePayload"},standalone:!0,features:[e.jDz],decls:3,vars:1,consts:[["else","","grafikNichtGeladen","",4,"ngIf"],["grafikNichtGeladen",""],["else","","grafikNichtGeladen",""],[4,"ngIf"],["class","bordered bg-white",4,"ngIf"],["fxLayout","row wrap","fxLayoutGap","20px","fxLayoutAlign","flex-start"],["fxFlex","0 1 calc(25%-20px)"],["mat-raised-button","","color","primary",3,"click"],[1,"bordered","bg-white"],["class","bg-white mt-1",4,"ngIf"],[1,"bg-white","mt-1"],[3,"src"],[3,"uploadModel","dateiAusgewaehlt","responsePayload"]],template:function(t,a){1&t&&(e.YNc(0,Ca,3,3,"div",0),e.YNc(1,ba,2,0,"ng-template",null,1,e.W1O)),2&t&&e.Q6J("ngIf",a.grafikSelected)},dependencies:[p.ez,p.O5,p.Ov,Q.Yr,L.ot,L.lW]});class se{constructor(){Me.add(this),this.raetselFacade=(0,e.f3M)(S),this.authFacade=(0,e.f3M)(W.jE),this.grafikFacade=(0,e.f3M)(M),this.dialog=(0,e.f3M)(we.uw),at.set(this,(0,e.f3M)(Ue.F0)),ye.set(this,new b.w0),F.set(this,void 0)}ngOnInit(){(0,s.YH)(this,ye,this.raetselFacade.raetselDetails$.pipe((0,R.b)(t=>{console.log("raetselDetails changed"),(0,s.YH)(this,F,t,"f")})).subscribe(),"f")}ngOnDestroy(){(0,s.Q_)(this,ye,"f").unsubscribe()}startEdit(){(0,s.Q_)(this,F,"f")&&this.raetselFacade.editRaetsel()}printPNG(){(0,s.Q_)(this,Me,"m",nt).call(this,"PNG")}printPDF(){(0,s.Q_)(this,Me,"m",nt).call(this,"PDF")}gotoRaetselUebersicht(){(0,s.Q_)(this,at,"f").navigateByUrl("/raetsel")}generierenDiabled(){return(0,s.Q_)(this,F,"f").grafikInfos.filter(a=>!a.existiert).length>0}grafikLaden(t){this.grafikFacade.grafikPruefen(t)}onGrafikHochgeladen(t){"INFO"===t.level&&this.raetselFacade.selectRaetsel((0,s.Q_)(this,F,"f"))}downloadLatexLogs(){(0,s.Q_)(this,F,"f")&&this.raetselFacade.downloadLatexLogs((0,s.Q_)(this,F,"f").schluessel)}}at=new WeakMap,ye=new WeakMap,F=new WeakMap,Me=new WeakSet,nt=function(t){const a={titel:t+" generieren",showVerwendungszwecke:!1,verwendungszwecke:[],selectedVerwendungszweck:void 0,layoutsAntwortvorschlaegeInput:x.fq,selectedLayoutAntwortvorschlaege:void 0,fontNamen:x.tk,selectedFontName:void 0,schriftgroessen:x.oZ,selectedSchriftgroesse:void 0};this.dialog.open(Q.Q6,{height:"300px",width:"700px",data:a}).afterClosed().subscribe(o=>{if(o&&a.selectedLayoutAntwortvorschlaege){let l="NOOP";switch(a.selectedLayoutAntwortvorschlaege){case"Ankreuztabelle":l="ANKREUZTABELLE";break;case"Buchstaben":l="BUCHSTABEN";break;case"description":l="DESCRIPTION"}let f="STANDARD",v="NORMAL";if(o&&a.selectedFontName)switch(a.selectedFontName){case"Druckschrift (Leseanf\xe4nger)":f="DRUCK_BY_WOK";break;case"Fibel Nord":f="FIBEL_NORD";break;case"Fibel S\xfcd":f="FIBEL_SUED"}if(o&&a.selectedSchriftgroesse)switch(a.selectedSchriftgroesse){case"sehr gro\xdf":v="HUGE";break;case"gro\xdf":v="LARGE"}this.raetselFacade.generiereRaetselOutput((0,s.Q_)(this,F,"f").id,t,f,v,l)}})},se.\u0275fac=function(t){return new(t||se)},se.\u0275cmp=e.Xpm({type:se,selectors:[["mja-raetsel-details"]],standalone:!0,features:[e.jDz],decls:4,vars:3,consts:[[4,"ngIf"],["keinRaetsel",""],["fxLayout","column","fxLayoutGap","20px",4,"ngIf","ngIfElse"],["fxLayout","column","fxLayoutGap","20px"],["fxLayout","row","fxLayoutAlign","space-between"],["fxLayout","column"],[4,"ngFor","ngForOf"],[3,"images",4,"ngIf"],[3,"images"],["fxLayout","column","fxLayoutGap","10px"],[3,"antwortvorschlag"],["flex","","fxLayout","row","fxLayoutGap","10px","fxLayout.lt-sm","column"],["fxLayoutAlign","left center","fxFlex","20"],["fxFlexFill","","mat-raised-button","","color","primary",3,"click"],["fxLayoutAlign","left center","fxFlex","20",4,"ngIf"],["fxFlexFill","","mat-raised-button","","color","primary","matTooltip","PDF generieren",3,"disabled","click"],["fxFlexFill","","mat-raised-button","","color","primary","matTooltip","zur\xfcck zur Suche",3,"click"],[1,"container"],["fxLayoutAlign","left center","fxFlex","80"],["cdkTextareaAutosize","","rows","5","cols","120","disabled","true"],["autosize","cdkTextareaAutosize"],["fxFlexFill","","mat-raised-button","","color","primary","matTooltip","PNG Frage und L\xf6sung generieren",3,"disabled","click"],[3,"responsePayload"],["mat-icon-button","",3,"click"]],template:function(t,a){1&t&&(e.YNc(0,Na,3,4,"div",0),e.ALo(1,"async"),e.YNc(2,Ga,4,0,"ng-template",null,1,e.W1O)),2&t&&e.Q6J("ngIf",e.lcZ(1,1,a.authFacade.user$))},dependencies:[p.ez,p.sg,p.O5,p.Ov,kt.XD,re.o9,g.xw,g.SQ,g.Wh,g.s9,g.yH,K.To,K.pp,K.ib,K.yz,K.yK,Ae.Hi,Ae.qn,Ae.HS,L.ot,L.lW,we.Is,X.Ps,X.Hw,E.lN,E.hX,Se.ie,Se.Hk,Se.Tg,Ee.AV,Ee.gM,Ze.Ky,Ze.IC,Q.GR,fa,ie],styles:[".container[_ngcontent-%COMP%]{margin:20pt 0 20pt 5pt}"]});var Rt=c(9643),G=c(3238),Ua=c(2687),Tt=c(1281),u=c(4006);const qa=["input"],Oa=function(n){return{enterDuration:n}},Pa=["*"],Ha=new e.OlP("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1})});let Ja=0;const Ya={provide:u.JU,useExisting:(0,e.Gpc)(()=>At),multi:!0};class za{constructor(t,a){this.source=t,this.checked=a}}const Wa=(0,G.sb)((0,G.pj)((0,G.Kr)((0,G.Id)(class{constructor(n){this._elementRef=n}}))));let ja=(()=>{class n extends Wa{constructor(a,i,o,l,f,v,rt){super(a),this._focusMonitor=i,this._changeDetectorRef=o,this.defaults=f,this._onChange=Cn=>{},this._onTouched=()=>{},this._required=!1,this._checked=!1,this.name=null,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.change=new e.vpe,this.toggleChange=new e.vpe,this.tabIndex=parseInt(l)||0,this.color=this.defaultColor=f.color||"accent",this._noopAnimations="NoopAnimations"===v,this.id=this._uniqueId=`${rt}${++Ja}`}get required(){return this._required}set required(a){this._required=(0,Tt.Ig)(a)}get checked(){return this._checked}set checked(a){this._checked=(0,Tt.Ig)(a),this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(a=>{"keyboard"===a||"program"===a?this._focused=!0:a||Promise.resolve().then(()=>{this._focused=!1,this._onTouched(),this._changeDetectorRef.markForCheck()})})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}writeValue(a){this.checked=!!a}registerOnChange(a){this._onChange=a}registerOnTouched(a){this._onTouched=a}setDisabledState(a){this.disabled=a,this._changeDetectorRef.markForCheck()}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(this._createChangeEvent(this.checked))}}return n.\u0275fac=function(a){e.$Z()},n.\u0275dir=e.lG2({type:n,inputs:{name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],required:"required",checked:"checked"},outputs:{change:"change",toggleChange:"toggleChange"},features:[e.qOj]}),n})(),At=(()=>{class n extends ja{constructor(a,i,o,l,f,v){super(a,i,o,l,f,v,"mat-slide-toggle-")}_createChangeEvent(a){return new za(this,a)}_onChangeEvent(a){a.stopPropagation(),this.toggleChange.emit(),this.defaults.disableToggleValue?this._inputElement.nativeElement.checked=this.checked:(this.checked=this._inputElement.nativeElement.checked,this._emitChangeEvent())}_onInputClick(a){a.stopPropagation()}focus(a,i){i?this._focusMonitor.focusVia(this._inputElement,i,a):this._inputElement.nativeElement.focus(a)}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}}return n.\u0275fac=function(a){return new(a||n)(e.Y36(e.SBq),e.Y36(Ua.tE),e.Y36(e.sBO),e.$8M("tabindex"),e.Y36(Ha),e.Y36(e.QbO,8))},n.\u0275cmp=e.Xpm({type:n,selectors:[["mat-slide-toggle"]],viewQuery:function(a,i){if(1&a&&e.Gf(qa,5),2&a){let o;e.iGM(o=e.CRH())&&(i._inputElement=o.first)}},hostAttrs:[1,"mat-slide-toggle"],hostVars:13,hostBindings:function(a,i){2&a&&(e.Ikx("id",i.id),e.uIk("tabindex",null)("aria-label",null)("aria-labelledby",null)("name",null),e.ekj("mat-checked",i.checked)("mat-disabled",i.disabled)("mat-slide-toggle-label-before","before"==i.labelPosition)("_mat-animation-noopable",i._noopAnimations))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matSlideToggle"],features:[e._Bn([Ya]),e.qOj],ngContentSelectors:Pa,decls:14,vars:20,consts:[[1,"mat-slide-toggle-label"],["label",""],[1,"mat-slide-toggle-bar"],["type","checkbox","role","switch",1,"mat-slide-toggle-input","cdk-visually-hidden",3,"id","required","tabIndex","checked","disabled","change","click"],["input",""],[1,"mat-slide-toggle-thumb-container"],[1,"mat-slide-toggle-thumb"],["mat-ripple","",1,"mat-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-slide-toggle-persistent-ripple"],[1,"mat-slide-toggle-content",3,"cdkObserveContent"],["labelContent",""],[2,"display","none"]],template:function(a,i){if(1&a&&(e.F$t(),e.TgZ(0,"label",0,1)(2,"span",2)(3,"input",3,4),e.NdJ("change",function(l){return i._onChangeEvent(l)})("click",function(l){return i._onInputClick(l)}),e.qZA(),e.TgZ(5,"span",5),e._UZ(6,"span",6),e.TgZ(7,"span",7),e._UZ(8,"span",8),e.qZA()()(),e.TgZ(9,"span",9,10),e.NdJ("cdkObserveContent",function(){return i._onLabelTextChange()}),e.TgZ(11,"span",11),e._uU(12,"\xa0"),e.qZA(),e.Hsn(13),e.qZA()()),2&a){const o=e.MAs(1),l=e.MAs(10);e.uIk("for",i.inputId),e.xp6(2),e.ekj("mat-slide-toggle-bar-no-side-margin",!l.textContent||!l.textContent.trim()),e.xp6(1),e.Q6J("id",i.inputId)("required",i.required)("tabIndex",i.tabIndex)("checked",i.checked)("disabled",i.disabled),e.uIk("name",i.name)("aria-checked",i.checked)("aria-label",i.ariaLabel)("aria-labelledby",i.ariaLabelledby)("aria-describedby",i.ariaDescribedby),e.xp6(4),e.Q6J("matRippleTrigger",o)("matRippleDisabled",i.disableRipple||i.disabled)("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",e.VKq(18,Oa,i._noopAnimations?0:150))}},dependencies:[G.wG,Rt.wD],styles:['.mat-slide-toggle{display:inline-block;height:24px;max-width:100%;line-height:24px;white-space:nowrap;outline:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(16px, 0, 0)}[dir=rtl] .mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(-16px, 0, 0)}.mat-slide-toggle.mat-disabled{opacity:.38}.mat-slide-toggle.mat-disabled .mat-slide-toggle-label,.mat-slide-toggle.mat-disabled .mat-slide-toggle-thumb-container{cursor:default}.mat-slide-toggle-label{-webkit-user-select:none;user-select:none;display:flex;flex:1;flex-direction:row;align-items:center;height:inherit;cursor:pointer}.mat-slide-toggle-content{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-slide-toggle-label-before .mat-slide-toggle-label{order:1}.mat-slide-toggle-label-before .mat-slide-toggle-bar{order:2}[dir=rtl] .mat-slide-toggle-label-before .mat-slide-toggle-bar,.mat-slide-toggle-bar{margin-right:8px;margin-left:0}[dir=rtl] .mat-slide-toggle-bar,.mat-slide-toggle-label-before .mat-slide-toggle-bar{margin-left:8px;margin-right:0}.mat-slide-toggle-bar-no-side-margin{margin-left:0;margin-right:0}.mat-slide-toggle-thumb-container{position:absolute;z-index:1;width:20px;height:20px;top:-3px;left:0;transform:translate3d(0, 0, 0);transition:all 80ms linear;transition-property:transform}._mat-animation-noopable .mat-slide-toggle-thumb-container{transition:none}[dir=rtl] .mat-slide-toggle-thumb-container{left:auto;right:0}.mat-slide-toggle-thumb{height:20px;width:20px;border-radius:50%;display:block}.mat-slide-toggle-bar{position:relative;width:36px;height:14px;flex-shrink:0;border-radius:8px}.mat-slide-toggle-input{bottom:0;left:10px}[dir=rtl] .mat-slide-toggle-input{left:auto;right:10px}.mat-slide-toggle-bar,.mat-slide-toggle-thumb{transition:all 80ms linear;transition-property:background-color;transition-delay:50ms}._mat-animation-noopable .mat-slide-toggle-bar,._mat-animation-noopable .mat-slide-toggle-thumb{transition:none}.mat-slide-toggle .mat-slide-toggle-ripple{position:absolute;top:calc(50% - 20px);left:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-slide-toggle .mat-slide-toggle-ripple .mat-ripple-element:not(.mat-slide-toggle-persistent-ripple){opacity:.12}.mat-slide-toggle-persistent-ripple{width:100%;height:100%;transform:none}.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:.04}.mat-slide-toggle:not(.mat-disabled).cdk-keyboard-focused .mat-slide-toggle-persistent-ripple{opacity:.12}.mat-slide-toggle-persistent-ripple,.mat-slide-toggle.mat-disabled .mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:0}@media(hover: none){.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{display:none}}.mat-slide-toggle-input:focus~.mat-slide-toggle-thumb-container .mat-focus-indicator::before{content:""}.cdk-high-contrast-active .mat-slide-toggle-thumb,.cdk-high-contrast-active .mat-slide-toggle-bar{border:1px solid}'],encapsulation:2,changeDetection:0}),n})(),wt=(()=>{class n{}return n.\u0275fac=function(a){return new(a||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({}),n})(),Ba=(()=>{class n{}return n.\u0275fac=function(a){return new(a||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[wt,G.si,G.BQ,Rt.Q8,wt,G.BQ]}),n})();var A,h,Fe,it,Le,V,St,st,Et,ot,Zt,lt,Dt;function Va(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"Schl\xfcssel ist Pflicht"),e.qZA())}function Xa(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"genau 5 Ziffern - nach links mit 0 auff\xfcllen "),e.qZA())}function en(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"Name ist Pflicht"),e.qZA())}function tn(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"maximal 100 Zeichen"),e.qZA())}function an(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"maximal 200 Zeichen"),e.qZA())}function nn(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"Quelle ist Pflicht"),e.qZA())}function sn(n,t){if(1&n&&(e.TgZ(0,"option",39),e._uU(1),e.qZA()),2&n){const a=t.$implicit;e.Q6J("value",a),e.xp6(1),e.Oqu(a)}}function on(n,t){if(1&n&&e._UZ(0,"mja-frage-loesung-images",40),2&n){const a=e.oxw().ngIf;e.Q6J("images",a.images)}}function ln(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"Frage ist Pflicht"),e.qZA())}function rn(n,t){if(1&n&&(e.TgZ(0,"option",39),e._uU(1),e.qZA()),2&n){const a=t.$implicit;e.Q6J("value",a),e.xp6(1),e.Oqu(a)}}function cn(n,t){if(1&n&&(e.TgZ(0,"div")(1,"h3"),e._uU(2),e.qZA(),e.TgZ(3,"div",41)(4,"div",9)(5,"mat-form-field",10)(6,"mat-label"),e._uU(7,"Text"),e.qZA(),e._UZ(8,"input",42,43),e.TgZ(10,"mat-hint"),e._uU(11,"Text des Antwortvorschlags - Wort oder kurze Wortgruppe"),e.qZA()()(),e.TgZ(12,"div",9)(13,"mat-slide-toggle",44,45),e._uU(15," korrekt (nein/ja)"),e.qZA()()()()),2&n){const a=t.$implicit,i=t.index,o=e.oxw(2);e.xp6(2),e.hij("Antwortvorschlag ",o.getBuchstabe(i),""),e.xp6(1),e.Q6J("formGroup",a)}}function dn(n,t){1&n&&(e.TgZ(0,"mat-error"),e._uU(1,"Antwortvorschl\xe4ge sind noch fehlerhaft: genau einer muss korrekt sein."),e.qZA())}function fn(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div")(1,"mja-select-items",46),e.NdJ("modelChanged",function(o){e.CHM(a);const l=e.oxw(2);return e.KtG(l.onSelectItemsCompomentModelChanged(o))}),e.qZA()()}if(2&n){const a=e.oxw(2);e.xp6(1),e.Q6J("model",a.selectItemsCompomentModel)}}function _n(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div",33)(1,"button",47),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(2);return e.KtG(o.downloadLatexLogs())}),e._uU(2,"LaTeX-Logs"),e.qZA()()}}function un(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div",33)(1,"button",48),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(2);return e.KtG(o.cancelEdit())}),e._uU(2,"Abbruch/Details"),e.qZA()()}}function mn(n,t){1&n&&(e.TgZ(0,"div",49),e._uU(1," Tja, das kann so noch nicht gespeichert werden. Es gibt noch Validierungsfehler, z.B. fehlende Pflichtangaben und so. "),e.qZA())}function pn(n,t){if(1&n){const a=e.EpF();e.TgZ(0,"div",3)(1,"h2"),e._uU(2,"R\xe4tseleditor"),e.qZA(),e.TgZ(3,"div",4)(4,"div",5)(5,"mat-label"),e._uU(6,"ID:"),e.qZA()(),e.TgZ(7,"div",6),e._uU(8),e.qZA()(),e.TgZ(9,"form",7)(10,"div",8)(11,"div",9)(12,"mat-form-field",10)(13,"mat-label"),e._uU(14,"Schl\xfcssel"),e.qZA(),e._UZ(15,"input",11,12),e.TgZ(17,"mat-hint"),e._uU(18,"genau 5 Ziffern - verwendet als Dateiname f\xfcr generierte Bilder"),e.qZA(),e.YNc(19,Va,2,0,"mat-error",13),e.YNc(20,Xa,2,0,"mat-error",13),e.qZA()(),e.TgZ(21,"div",9)(22,"mat-form-field",10)(23,"mat-label"),e._uU(24,"Name"),e.qZA(),e._UZ(25,"input",14,15),e.TgZ(27,"mat-hint"),e._uU(28,"wird in der Trefferliste angezeigt"),e.qZA(),e.YNc(29,en,2,0,"mat-error",13),e.YNc(30,tn,2,0,"mat-error",13),e.qZA()(),e.TgZ(31,"div",9)(32,"mat-form-field",10)(33,"mat-label"),e._uU(34,"Kommentar"),e.qZA(),e._UZ(35,"input",16,17),e.TgZ(37,"mat-hint"),e._uU(38,"Kommentare sind in Volltextsuche eingebunden"),e.qZA(),e.YNc(39,an,2,0,"mat-error",13),e.qZA()(),e.TgZ(40,"div",8)(41,"div",18)(42,"mat-form-field",10)(43,"mat-label"),e._uU(44,"ID der Quelle"),e.qZA(),e._UZ(45,"input",19,20),e.TgZ(47,"mat-hint"),e._uU(48),e.qZA(),e.YNc(49,nn,2,0,"mat-error",13),e.qZA()()(),e.TgZ(50,"div",9)(51,"mat-form-field",10)(52,"mat-label"),e._uU(53,"Status"),e.qZA(),e.TgZ(54,"select",21,22),e.YNc(56,sn,2,2,"option",23),e.qZA()()(),e.YNc(57,on,1,1,"mja-frage-loesung-images",24),e.TgZ(58,"div",9)(59,"mat-form-field",10)(60,"mat-label"),e._uU(61,"Frage"),e.qZA(),e._UZ(62,"textarea",25,26),e.TgZ(65,"mat-hint"),e._uU(66,"LaTeX-Schnipsel ohne Pr\xe4ambel und document-Umgebung"),e.qZA(),e.YNc(67,ln,2,0,"mat-error",13),e.qZA()(),e.TgZ(68,"div",9)(69,"mat-form-field",10)(70,"mat-label"),e._uU(71,"L\xf6sung"),e.qZA(),e._UZ(72,"textarea",27,28),e.TgZ(75,"mat-hint"),e._uU(76,"LaTeX-Schnipsel ohne Pr\xe4ambel und document-Umgebung"),e.qZA()()(),e.TgZ(77,"div",9)(78,"mat-form-field",10)(79,"mat-label"),e._uU(80,"Anzahl Antwortvorschl\xe4ge"),e.qZA(),e.TgZ(81,"select",29,30),e.NdJ("change",function(o){e.CHM(a);const l=e.oxw();return e.KtG(l.onChangeAnzahlAntwortvorschlaege(o))}),e.YNc(83,rn,2,2,"option",23),e.qZA()()()(),e.YNc(84,cn,16,2,"div",31),e.YNc(85,dn,2,0,"mat-error",13),e.qZA(),e.YNc(86,fn,2,1,"div",13),e.TgZ(87,"div",32)(88,"div",33)(89,"button",34),e.NdJ("click",function(){e.CHM(a);const o=e.oxw();return e.KtG(o.submit())}),e._uU(90,"speichern"),e.qZA()(),e.TgZ(91,"div",33)(92,"button",35),e.NdJ("click",function(){e.CHM(a);const o=e.oxw();return e.KtG(o.printPNG())}),e._uU(93,"PNG generieren"),e.qZA()(),e.YNc(94,_n,3,0,"div",36),e.ALo(95,"async"),e.YNc(96,un,3,0,"div",36),e.TgZ(97,"div",33)(98,"button",37),e.NdJ("click",function(){e.CHM(a);const o=e.oxw();return e.KtG(o.gotoSuche())}),e._uU(99,"R\xe4tselsuche"),e.qZA()()(),e.YNc(100,mn,2,0,"div",38),e.qZA()}if(2&n){const a=t.ngIf,i=e.oxw(),o=e.MAs(5);e.xp6(8),e.Oqu(a.id),e.xp6(1),e.Q6J("formGroup",i.form),e.xp6(10),e.Q6J("ngIf",i.raetselDataError("schluessel","required")),e.xp6(1),e.Q6J("ngIf",i.raetselDataError("schluessel","pattern")),e.xp6(9),e.Q6J("ngIf",i.raetselDataError("name","required")),e.xp6(1),e.Q6J("ngIf",i.raetselDataError("name","maxLength")),e.xp6(9),e.Q6J("ngIf",i.raetselDataError("kommentar","maxLength")),e.xp6(9),e.Oqu(a.quelle.name),e.xp6(1),e.Q6J("ngIf",i.raetselDataError("quelleId","required")),e.xp6(7),e.Q6J("ngForOf",i.selectStatusInput),e.xp6(1),e.Q6J("ngIf",a.images)("ngIfElse",o),e.xp6(5),e.Q6J("cdkAutosizeMinRows",5)("cdkAutosizeMaxRows",15),e.xp6(5),e.Q6J("ngIf",i.raetselDataError("frage","required")),e.xp6(5),e.Q6J("cdkAutosizeMinRows",5)("cdkAutosizeMaxRows",15),e.xp6(11),e.Q6J("ngForOf",i.anzahlenAntwortvorschlaege),e.xp6(1),e.Q6J("ngForOf",i.antwortvorschlaegeFormGroup),e.xp6(1),e.Q6J("ngIf",i.antwortvorschlaegeErrors()),e.xp6(1),e.Q6J("ngIf",i.selectItemsCompomentModel),e.xp6(3),e.Q6J("disabled",!i.form.valid||i.antwortvorschlaegeErrors()),e.xp6(3),e.Q6J("disabled",i.generierenDiabled()),e.xp6(2),e.Q6J("ngIf",e.lcZ(95,26,i.raetselFacade.generateLatexError$)),e.xp6(2),e.Q6J("ngIf","neu"!==a.id),e.xp6(4),e.Q6J("ngIf",!i.form.valid||i.antwortvorschlaegeErrors())}}function gn(n,t){1&n&&(e.TgZ(0,"h2"),e._uU(1,"R\xe4tseleditor"),e.qZA(),e.TgZ(2,"p"),e._uU(3,"kein R\xe4tsel ausgew\xe4hlt"),e.qZA())}function hn(n,t){1&n&&(e.TgZ(0,"p"),e._uU(1,"noch keine Images generiert"),e.qZA())}class oe{constructor(){A.add(this),h.set(this,void 0),Fe.set(this,(0,e.f3M)(u.QS)),it.set(this,(0,e.f3M)(Oe.CI)),Le.set(this,new b.w0),V.set(this,[]),this.anzahlenAntwortvorschlaege=["0","2","3","5","6"],this.selectStatusInput=["ERFASST","FREIGEGEBEN"],this.dialog=(0,e.f3M)(we.uw),this.raetselFacade=(0,e.f3M)(S),this.grafikFacade=(0,e.f3M)(M),this.raetselDataError=(t,a)=>this.form.controls[t].hasError(a),this.form=(0,s.Q_)(this,Fe,"f").group({schluessel:["",[u.kI.required,u.kI.pattern("^[0-9]{5}$")]],name:["",[u.kI.required,u.kI.maxLength(100)]],quelleId:["",[u.kI.required]],status:["",[u.kI.required]],frage:["",[u.kI.required]],loesung:[""],kommentar:[""],anzahlAntwortvorschlaege:["0"],antwortvorschlaege:new u.vC([])})}ngOnInit(){(0,s.YH)(this,Le,(0,gt.a)([this.raetselFacade.raetselDetails$,(0,s.Q_)(this,it,"f").alleDeskriptoren$]).subscribe(([t,a])=>{(0,s.YH)(this,h,{...t},"f"),(0,s.YH)(this,V,(0,s.Q_)(this,h,"f").deskriptoren,"f"),this.selectItemsCompomentModel=this.raetselFacade.initSelectItemsCompomentModel((0,s.Q_)(this,h,"f").deskriptoren,a),(0,s.Q_)(this,A,"m",St).call(this)}),"f")}ngOnDestroy(){(0,s.Q_)(this,Le,"f").unsubscribe()}isFormValid(){return!!this.form.valid}getBuchstabe(t){switch(t){case 0:return"A";case 1:return"B";case 2:return"C";case 3:return"D";case 4:return"E";case 5:return"F"}return""}get avFormArray(){return this.form.controls.antwortvorschlaege}get antwortvorschlaegeFormGroup(){return this.avFormArray.controls}antwortvorschlaegeErrors(){const t=(0,s.Q_)(this,A,"m",ot).call(this);if(0===t.length)return!1;let a=0;return t.forEach(i=>{i.korrekt&&a++}),1!==a}generierenDiabled(){const t=(0,s.Q_)(this,h,"f").grafikInfos.filter(a=>!a.existiert);return!this.form.valid||this.antwortvorschlaegeErrors()||t.length>0}onChangeAnzahlAntwortvorschlaege(t){const a=parseInt(t.target.value);(0,s.Q_)(this,A,"m",st).call(this,a)}onSelectItemsCompomentModelChanged(t){if(t){const a=t.gewaehlteItems;(0,s.YH)(this,V,[],"f"),a.forEach(i=>(0,s.Q_)(this,V,"f").push({id:i.id,name:i.name}))}}cancelEdit(){(0,s.Q_)(this,h,"f")&&"neu"!==(0,s.Q_)(this,h,"f").id?this.raetselFacade.selectRaetsel((0,s.Q_)(this,h,"f")):this.raetselFacade.cancelSelection()}gotoSuche(){this.raetselFacade.cancelSelection()}printPNG(){(0,s.Q_)(this,A,"m",Dt).call(this,"PNG")}openHistorieLaTeXSpeichernDialog(t){this.dialog.open(Q.Tb,{height:"300px",width:"700px",data:{frage:"Soll Historie gespeichert werden?",hinweis:"Bitte nur bei inhaltlichen Korrekturen. Das spart Speicherplatz"}}).afterClosed().subscribe(o=>{(0,s.Q_)(this,A,"m",lt).call(this,t,o)})}submit(){const t=(0,s.Q_)(this,A,"m",Et).call(this);(0,s.Q_)(this,A,"m",Zt).call(this,t)?this.openHistorieLaTeXSpeichernDialog(t):(0,s.Q_)(this,A,"m",lt).call(this,t,!1)}grafikLaden(t){this.grafikFacade.grafikPruefen(t)}onGrafikHochgeladen(t){}downloadLatexLogs(){(0,s.Q_)(this,h,"f")&&(0,s.Q_)(this,h,"f").schluessel&&this.raetselFacade.downloadLatexLogs((0,s.Q_)(this,h,"f").schluessel)}}h=new WeakMap,Fe=new WeakMap,it=new WeakMap,Le=new WeakMap,V=new WeakMap,A=new WeakSet,St=function(){const t=(0,s.Q_)(this,h,"f");this.form.controls.schluessel.setValue(t.schluessel),this.form.controls.name.setValue(t.name),this.form.controls.quelleId.setValue(t.quelle.id),this.form.controls.status.setValue(t.status),this.form.controls.frage.setValue(t.frage),this.form.controls.loesung.setValue(t.loesung),this.form.controls.kommentar.setValue(t.kommentar),this.form.controls.anzahlAntwortvorschlaege.setValue(t.antwortvorschlaege.length+""),(0,s.Q_)(this,A,"m",st).call(this,t.antwortvorschlaege.length);for(let a=0;a<t.antwortvorschlaege.length;a++){const i=this.avFormArray.at(a),o=t.antwortvorschlaege[a];i.setValue({text:o.text,korrekt:o.korrekt})}},st=function(t){if(this.avFormArray.length<t)for(let a=this.avFormArray.length;a<t;a++)this.avFormArray.push((0,s.Q_)(this,Fe,"f").group({text:["",[u.kI.required,u.kI.maxLength(30)]],korrekt:[!1,[u.kI.required]]}));else for(let a=this.avFormArray.length;a>=t;a--)this.avFormArray.removeAt(a)},Et=function(){const t=this.form.value,a=(0,s.Q_)(this,A,"m",ot).call(this);return{...(0,s.Q_)(this,h,"f"),schluessel:t.schluessel.trim(),name:null!==t.name?t.name.trim():"",status:t.status,kommentar:null!==t.kommentar?t.kommentar.trim():null,frage:null!==t.frage?t.frage.trim():"",loesung:null!==t.loesung?t.loesung.trim():null,antwortvorschlaege:a,deskriptoren:(0,s.Q_)(this,V,"f"),images:null}},ot=function(){const t=[];for(let a=0;a<this.avFormArray.length;a++){const i=this.avFormArray.at(a).value;t.push({buchstabe:this.getBuchstabe(a),text:i.text.trim(),korrekt:i.korrekt})}return t},Zt=function(t){return"neu"!==(0,s.Q_)(this,h,"f").id&&(t.frage!==(0,s.Q_)(this,h,"f").frage||t.loesung!==(0,s.Q_)(this,h,"f").loesung)},lt=function(t,a){this.raetselFacade.saveRaetsel({latexHistorisieren:a,raetsel:t})},Dt=function(t){const a={titel:t+" generieren",showVerwendungszwecke:!1,verwendungszwecke:[],selectedVerwendungszweck:void 0,layoutsAntwortvorschlaegeInput:x.fq,selectedLayoutAntwortvorschlaege:void 0,fontNamen:x.tk,selectedFontName:void 0,schriftgroessen:x.oZ,selectedSchriftgroesse:void 0};this.dialog.open(Q.Q6,{height:"300px",width:"700px",data:a}).afterClosed().subscribe(o=>{if(o&&a.selectedLayoutAntwortvorschlaege){let l="NOOP";switch(a.selectedLayoutAntwortvorschlaege){case"Ankreuztabelle":l="ANKREUZTABELLE";break;case"Buchstaben":l="BUCHSTABEN";break;case"description":l="DESCRIPTION"}let f="STANDARD",v="NORMAL";if(o&&a.selectedFontName)switch(a.selectedFontName){case"Druckschrift (Leseanf\xe4nger)":f="DRUCK_BY_WOK";break;case"Fibel Nord":f="FIBEL_NORD";break;case"Fibel S\xfcd":f="FIBEL_SUED"}if(o&&a.selectedSchriftgroesse)switch(a.selectedSchriftgroesse){case"sehr gro\xdf":v="HUGE";break;case"gro\xdf":v="LARGE"}this.raetselFacade.generiereRaetselOutput((0,s.Q_)(this,h,"f").id,t,f,v,l)}})},oe.\u0275fac=function(t){return new(t||oe)},oe.\u0275cmp=e.Xpm({type:oe,selectors:[["mja-raetsel-editor"]],standalone:!0,features:[e.jDz],decls:6,vars:4,consts:[["class","container",4,"ngIf","ngIfElse"],["keinRaetsel",""],["keineImagesGeneriert",""],[1,"container"],["fxLayout","row wrap","fxLayoutGap","20px","fxLayoutAlign","flex-start"],["fxFlex","0 1 calc(10%-20px)"],["fxFlex","0 1 calc(90%-20px)",1,"mb-1"],["novalidate","",3,"formGroup"],["fxLayout","column wrap","fxLayoutGap","10px","fxLayoutAlign","flex-start"],[1,"mb-2"],["appearance","fill",1,"form-box"],["matInput","","maxlength","5","inputmode","tel","placeholder","schluessel","formControlName","schluessel"],["schluesselInput",""],[4,"ngIf"],["matInput","","maxlength","100","placeholder","name","formControlName","name"],["nameInput",""],["matInput","","maxlength","200","placeholder","Kommentar","formControlName","kommentar"],["kommentarInput",""],[1,"mb-2","row"],["matInput","","maxlength","36","placeholder","Quelle","formControlName","quelleId"],["quelleIdInput",""],["matNativeControl","","formControlName","status"],["statusInput",""],[3,"value",4,"ngFor","ngForOf"],[3,"images",4,"ngIf","ngIfElse"],["matInput","","cdkTextareaAutosize","","placeholder","Frage","formControlName","frage",3,"cdkAutosizeMinRows","cdkAutosizeMaxRows"],["autosize","cdkTextareaAutosize","frageInput",""],["matInput","","cdkTextareaAutosize","","placeholder","L\xf6sung","formControlName","loesung",3,"cdkAutosizeMinRows","cdkAutosizeMaxRows"],["autosize","cdkTextareaAutosize","loesungInput",""],["matNativeControl","","formControlName","anzahlAntwortvorschlaege",3,"change"],["anzahlAntwortvorschlaegeInput",""],[4,"ngFor","ngForOf"],["flex","","fxLayout","row","fxLayoutGap","10px","fxLayout.lt-sm","column"],["fxLayoutAlign","left center","fxFlex","20"],["fxFlexFill","","mat-raised-button","","color","primary",3,"disabled","click"],["fxFlexFill","","mat-raised-button","","color","primary","matTooltip","PNG Frage und L\xf6sung generieren",3,"disabled","click"],["fxLayoutAlign","left center","fxFlex","20",4,"ngIf"],["fxFlexFill","","mat-raised-button","","color","primary","matTooltip","zur\xfcck zur Suche",3,"click"],["class","hint-red mt-1 mb-2",4,"ngIf"],[3,"value"],[3,"images"],[3,"formGroup"],["matInput","","maxlength","30","placeholder","Text","formControlName","text"],["textInput",""],["formControlName","korrekt","color","primary"],["korrektInput",""],[3,"model","modelChanged"],["fxFlexFill","","mat-raised-button","","color","primary","matTooltip","Logdateien herunterladen",3,"click"],["fxFlexFill","","mat-raised-button","","color","primary","matTooltip","zur\xfcck zur Detailansicht",3,"click"],[1,"hint-red","mt-1","mb-2"]],template:function(t,a){if(1&t&&(e.YNc(0,pn,101,28,"div",0),e.ALo(1,"async"),e.YNc(2,gn,4,0,"ng-template",null,1,e.W1O),e.YNc(4,hn,2,0,"ng-template",null,2,e.W1O)),2&t){const i=e.MAs(3);e.Q6J("ngIf",e.lcZ(1,2,a.raetselFacade.raetselDetails$))("ngIfElse",i)}},dependencies:[p.ez,p.sg,p.O5,p.Ov,L.ot,L.lW,Ae.Hi,we.Is,X.Ps,ue.c,Ze.IC,E.TO,E.KE,E.bx,E.hX,ue.Nt,E.lN,Se.ie,Ba,At,Ee.AV,Ee.gM,kt.XD,Ze.Ky,re.o9,g.xw,g.SQ,g.Wh,g.s9,g.yH,K.To,u.UX,u._Y,u.YN,u.Kr,u.Fj,u.EJ,u.JJ,u.JL,u.nD,u.sg,u.u,Q.GR,Q.NJ],styles:["mat-form-field[_ngcontent-%COMP%]{display:block}"]});const vn=[{path:"uebersicht",canActivate:[()=>(0,e.f3M)(W.jE).userIsLoggedIn$],component:j,providers:[_e,Ie]},{path:"details",canActivate:[()=>(0,e.f3M)(W.jE).userIsLoggedIn$],component:se,providers:[_e,Ie]},{path:"editor",canActivate:[()=>(0,e.f3M)(W.jE).userIsAdmin$],component:oe,providers:[_e,Ie]},{path:"",pathMatch:"full",canActivate:[()=>(0,e.f3M)(W.jE).userIsLoggedIn$],component:j,providers:[_e,Ie]}]}}]);