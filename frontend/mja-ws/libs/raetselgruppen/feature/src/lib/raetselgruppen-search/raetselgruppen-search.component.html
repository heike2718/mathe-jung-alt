<h1>Aufgabensammlungen</h1>

<div class="button-container">
  <div>
    <button mat-raised-button color="primary" (click)="resetAllFilters()"
      [disabled]="buttonResetAllFiltersDisabled()">Filter leeren</button>
  </div>
  <div>
    <button mat-raised-button color="primary" (click)="neueRaetselgruppe()" title="neue Aufgabensammlung anlegen">neue
      Sammlung</button>
  </div>
</div>

<div *ngIf="showSuchparameter()" class="grid-container-2 mt-2 mb-2">
  <label>Suchparameter</label>
  <div>{{suchparameterStr}}</div>
</div>

<mat-paginator [length]="anzahlRaetselgruppen" [pageSizeOptions]="[20,30,50]" showFirstLastButtons></mat-paginator>

<mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8 mt-2" matSort matSortActive="name"
  matSortDirection="asc" matSortDisableClear>

  <!-- status -->
  <ng-container matColumnDef="status">
    <mat-header-cell *matHeaderCellDef class="mat-header-cell__1"> </mat-header-cell>
    <mat-cell *matCellDef="let gruppe" class="mat-cell__1"> <span *ngIf="!gruppe.freigegeben">
        <mat-icon>block</mat-icon>
      </span>
      <span *ngIf="gruppe.freigegeben">
        <mat-icon>check_circle_outline</mat-icon>
      </span>
    </mat-cell>
  </ng-container>

  <!-- name -->
  <ng-container matColumnDef="name">
    <mat-header-cell *matHeaderCellDef>
      <div class="grid-container-1">
        <label mat-sort-header>
          Name
        </label>
        <mat-form-field class="filter input-wrapper__non-suffix" floatLabel="always" appearance="outline">
          <input matInput [formControl]="nameFilterControl" type="text" #nameFilterInput />
          <button mat-button *ngIf="nameFilterInput.value" matSuffix mat-icon-button
            class="mat-form-field-suffix__clear" aria-label="Clear" (click)="clearFilter(nameFilterControl)">
            <mat-icon>
              close
            </mat-icon>
          </button>
        </mat-form-field>
      </div>
    </mat-header-cell>
    <mat-cell *matCellDef="let gruppe">
      {{gruppe.name}} ({{gruppe.anzahlElemente}})
    </mat-cell>>
  </ng-container>

  <!-- schwierigkeitsgrad -->
  <ng-container matColumnDef="schwierigkeitsgrad">
    <mat-header-cell *matHeaderCellDef>
      <div class="grid-container-1">
        <label>
          Level
        </label>
        <mat-form-field class="filter input-wrapper__non-suffix" floatLabel="always" appearance="outline">
          <mat-select floatLabel="always" [formControl]="schwierigkeitsgradSelectFilterControl">
            <mat-option *ngFor="let level of schwierigkeitsgrade" [value]="level">
              {{ level.label }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </mat-header-cell>
    <mat-cell *matCellDef="let gruppe"> {{gruppe.schwierigkeitsgrad}} </mat-cell>
  </ng-container>

  <!-- referenztyp -->
  <ng-container matColumnDef="referenztyp">
    <mat-header-cell *matHeaderCellDef>
      <div class="grid-container-1">
        <label mat-sort-header>
          Referenztyp
        </label>
        <mat-form-field class="filter input-wrapper__non-suffix" floatLabel="always" appearance="outline">
          <mat-select floatLabel="always" [formControl]="referenztypSelectFilterControl">
            <mat-option *ngFor="let reftyp of referenztypen" [value]="reftyp">
              {{ reftyp.label }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </mat-header-cell>
    <mat-cell *matCellDef="let gruppe" class="mat-cell__4"> {{gruppe.referenztyp}} </mat-cell>
  </ng-container>

  <!-- referenz -->
  <ng-container matColumnDef="referenz">
    <mat-header-cell *matHeaderCellDef>
      <div class="grid-container-1">
        <label mat-sort-header>
          Referenz
        </label>
        <mat-form-field class="filter">
          <input matInput [formControl]="referenzFilterControl" type="text" #referenzFilterInput />          
        </mat-form-field>
      </div>
    </mat-header-cell>
    <mat-cell *matCellDef="let gruppe"> {{gruppe.referenz}} </mat-cell>
  </ng-container>

  <mat-header-row *matHeaderRowDef="getDisplayedColumns(); sticky: true"></mat-header-row>
  <mat-row *matRowDef="let row; columns: getDisplayedColumns()" (click)="onRowClicked(row)"></mat-row>

</mat-table>